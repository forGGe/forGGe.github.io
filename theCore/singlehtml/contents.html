

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>theCore documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="None" href="contents.html#document-index"/>
 

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5WCW8RS');</script>
<!-- End Google Tag Manager -->


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="contents.html#document-contents" class="icon icon-home"> theCore
          

          
          </a>

          
            
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-index">theCore: C++ Embedded Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-guides/index">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-examples/index">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-project_structure">Project structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-arch">Supported architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-platform/index">Supported platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-drivers">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-utilities">Libraries and utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-os_layer">OS abstraction layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-community">Community and developer guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-docs">Documentation development and contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-testing">Testing and CI</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html#document-credits">Credits and acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="contents.html#document-contents">theCore</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="contents.html#document-contents">Docs</a> &raquo;</li>
      
    <li>theCore  documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5WCW8RS"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

  <div class="section" id="thecore-c-embedded-framework">
<h1>theCore: C++ Embedded Framework<a class="headerlink" href="#thecore-c-embedded-framework" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This documentation is under construction.
You may find that many sections are incomplete.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a single-page version of theCore documentation.
For multi-page version, click <a class="reference external" href="http://forgge.github.io/theCore//">here</a>.</p>
</div>
<div class="toctree-wrapper compound" id="thecore-toc">
<span id="document-index"></span><div class="section" id="thecore-c-embedded-framework">
<h2>theCore: C++ Embedded Framework<a class="headerlink" href="#thecore-c-embedded-framework" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://travis-ci.org/forGGe/theCore"><img alt="Build Status" src="https://travis-ci.org/forGGe/theCore.svg?branch=master" /></a>
<a class="reference external" href="https://t.me/joinchat/HQF-SEgtMQXoNOq_D71pSg"><img alt="Join the chat at https://t.me/joinchat/HQF-SEgtMQXoNOq_D71pSg" src="https://img.shields.io/badge/chat-telegram-blue.svg" /></a>
<a class="reference external" href="https://t.me/theCoreEmbedded"><img alt="Follow us at https://t.me/theCoreEmbedded" src="https://img.shields.io/badge/follow-telegram-blue.svg" /></a>
<a class="reference external" href="https://gitter.im/forGGe/theCore?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img alt="Join the chat at https://gitter.im/forGGe/theCore" src="https://badges.gitter.im/forGGe/theCore.svg" /></a></p>
<div class="section" id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h3>
<p>theCore is the open source, highly configurable and straightforward C++ embedded
framework aimed to reduce development, testing and hardware migration
efforts for a wide range of bare-metal embedded applications.</p>
<p>theCore tries to provide all that is necessary to create portable application code:</p>
<ul class="simple">
<li>Startup, initialization and periphery code for each supported platform.</li>
<li>Build system support for different platform and target configurations.</li>
<li>Platform-independent device drivers, like temperature sensors or displays.</li>
<li>Optional OS-related abstractions: semaphores, mutexes and threads.</li>
<li>Easy-to-deploy development environment.</li>
<li>Different libraries and utilities.</li>
</ul>
<p>theCore uses powerful type system based on modern C++ and code generation that
greatly reduces error rate and debugging time. Shifting different sanity checks
to compile time rather than runtime not only makes code more performant, but
also secure and easier to extend.</p>
<p>The project is at the initial stage. You can check <a class="reference internal" href="contents.html#thecore-roadmap"><span class="std std-ref">Roadmap</span></a> section
in the documentation or <a class="reference external" href="https://github.com/forGGe/theCore/issues">github issues</a> to get insights on what happens
right now and where project is moving.</p>
</div>
<div class="section" id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<p>theCore documentation hosted on GitHub pages and available in two formats:
<a class="reference external" href="https://forgge.github.io/theCore/">multi-page HTML</a> for ease of navigation and <a class="reference external" href="https://forgge.github.io/theCore/singlehtml/contents.html">single-page HTML</a> for ease
of manual searching.</p>
</div>
<div class="section" id="where-to-get-thecore">
<h3>Where to get theCore<a class="headerlink" href="#where-to-get-thecore" title="Permalink to this headline">¶</a></h3>
<p>theCore is now available only from source and hosted solely on <a class="reference external" href="https://github.com/forGGe/theCore/">GitHub</a>.
There are different branches for development and stable versions. Check <a class="reference internal" href="contents.html#thecore-branching"><span class="std std-ref">Branching and release model</span></a>
section for information about branches purpose.</p>
</div>
<div class="section" id="getting-started">
<h3>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<p>You can start using theCore by completing guides and tutorials in the <a class="reference internal" href="contents.html#thecore-guides"><span class="std std-ref">Guides</span></a>
section or check the source code of <a class="reference external" href="https://github.com/forGGe/theCore-blinky">the standalone blinky example project</a>.</p>
<p>It is also worth to look at examples that are placed in <cite>examples</cite> dir and
read the <a class="reference internal" href="contents.html#thecore-examples"><span class="std std-ref">Examples</span></a> section to understand how to build and launch them.</p>
</div>
<div class="section" id="supported-platforms">
<h3>Supported platforms<a class="headerlink" href="#supported-platforms" title="Permalink to this headline">¶</a></h3>
<p>Supported platform list along with information about each platform is located
in <a class="reference internal" href="contents.html#thecore-platforms"><span class="std std-ref">Supported platforms</span></a> section.</p>
</div>
<div class="section" id="project-links">
<h3>Project links<a class="headerlink" href="#project-links" title="Permalink to this headline">¶</a></h3>
<p>Here a couple of additional references that you might be interest in:</p>
<ul class="simple">
<li><a class="reference external" href="https://mailmanlists.eu/mailman/listinfo/thecore">Mailing list</a>. For large discussions and announcements.</li>
<li><a class="reference external" href="https://t.me/joinchat/HQF-SEgtMQXoNOq_D71pSg">theCore Telegram group</a>. For discussions.</li>
<li><a class="reference external" href="https://t.me/theCoreEmbedded">theCore Telegram channel</a>. For announcements.</li>
<li><a class="reference external" href="https://twitter.com/theCoreEmbedded">theCore Twitter</a>. You can check some announcements there too.</li>
<li><a class="reference external" href="https://www.openhub.net/p/theCoreEmbedded">OpenHub page</a>. Pretty good and explanatory.</li>
</ul>
</div>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>The source code is distributed under <a class="reference external" href="https://www.mozilla.org/en-US/MPL/">MPL v2.0 License</a> (Mozilla Public License
Version 2.0).</p>
<p>MPL is like LGPL, but with static linking exception.</p>
<p>For many practical cases it means that <strong>you can use theCore in your proprietary
embedded applications without disclosing the application source code</strong>.</p>
<p>Keep it private, if needed. MPL allows you to do that.</p>
<p>Pay note though, that MPL is still a copy-left license. So you are obligated
to distribute any changes of theCore itself if there were any.</p>
<p>It is strongly recommended to read <a class="reference external" href="https://www.mozilla.org/en-US/MPL/2.0/FAQ/">MPL 2.0 FAQ</a> to get more familiar with it.</p>
</div>
<div class="section" id="technologies-and-projects-used">
<h3>Technologies and projects used<a class="headerlink" href="#technologies-and-projects-used" title="Permalink to this headline">¶</a></h3>
<p>Most notable are:</p>
<ul class="simple">
<li>C++11 and C++14 - as a main programming language standards.</li>
<li>Python 3 and <a class="reference external" href="https://nedbatchelder.com/code/cog/">cog</a> - code generation.</li>
<li><a class="reference external" href="http://www.stack.nl/~dimitri/doxygen/">Doxygen</a> and <a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a> - in-source and project-wide documentation.</li>
<li><a class="reference external" href="https://cmake.org/">CMake</a> - build-system.</li>
<li><a class="reference external" href="https://nixos.org/nix/">Nix</a> - development environment management.</li>
<li><a class="reference external" href="http://cpputest.github.io/">CppUTest</a> and <a class="reference external" href="http://www.throwtheswitch.org/unity/">Unity</a> - unit and on-device testing.</li>
<li><a class="reference external" href="https://travis-ci.org/forGGe/theCore/">Travis</a> - continuos integration.</li>
</ul>
<p>Check the <a class="reference internal" href="contents.html#thecore-credits"><span class="std std-ref">Credits and acknowledgements</span></a> section for more.</p>
</div>
<div class="section" id="contribution-using">
<h3>Contribution &amp; Using<a class="headerlink" href="#contribution-using" title="Permalink to this headline">¶</a></h3>
<p>The project is on its very beginning, so any help is more than welcome
and highly appreciated. If you’d like to take a part in the project
growth and (or) have any questions – take a look at <a class="reference internal" href="contents.html#thecore-developerdocs"><span class="std std-ref">Community and developer guidelines</span></a> section,
leave message at <a class="reference external" href="https://t.me/joinchat/HQF-SEgtMQXoNOq_D71pSg">theCore Telegram group</a>, <a class="reference external" href="https://mailmanlists.eu/mailman/listinfo/thecore">mailing list</a> <a class="reference external" href="https://gitter.im/forGGe/theCore">gitter</a>, contact me
directly at <a class="reference external" href="mailto:forgge&#37;&#52;&#48;gmail&#46;com">forgge<span>&#64;</span>gmail<span>&#46;</span>com</a>, or simply check out <a class="reference external" href="https://github.com/forGGe/theCore/issues">a list of theCore issues</a>.</p>
<p>If you have any suggestions on theCore improvement or just
like it how it is, don’t keep silence! I’ll be happy to read your
reviews.</p>
<p>You are welcome to use theCore in your own projects. If there is
something that it’s not enough for this, please let me know via email or
open some issues and we will do our best to handle this ASAP. Good luck!</p>
</div>
</div>
<span id="document-guides/index"></span><div class="section" id="guides">
<span id="thecore-guides"></span><h2>Guides<a class="headerlink" href="#guides" title="Permalink to this headline">¶</a></h2>
<p>This page presents different guides that will help you master embedded
programming skills with theCore.</p>
<div class="toctree-wrapper compound">
<span id="document-guides/getting-started"></span><div class="section" id="getting-started">
<span id="thecore-gettingstarted"></span><h3>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<div class="section" id="downloading-thecore">
<h4>Downloading theCore<a class="headerlink" href="#downloading-thecore" title="Permalink to this headline">¶</a></h4>
<p>First thing first you need to clone and update all modules of theCore.</p>
<ol class="arabic">
<li><p class="first">Clone repository:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">forGGe</span><span class="o">/</span><span class="n">theCore</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p class="first">Update all submodules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">submodule</span> <span class="n">update</span> <span class="o">--</span><span class="n">init</span> <span class="o">--</span><span class="n">recursive</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="deploying-development-environment">
<h4>Deploying development environment<a class="headerlink" href="#deploying-development-environment" title="Permalink to this headline">¶</a></h4>
<p>Now it is time to get the development environment - toolchains,
build dependencies and some additional host utilities. Everything that
you need during development of the embedded application.</p>
<p>You can either do it manually and spend decent time on that or ask
package manager called <a class="reference external" href="https://nixos.org/nix/">Nix</a> to setup all the development packages for you.</p>
<p>If you prefer to manually install dependencies, refer to <a class="reference internal" href="contents.html#thecore-nonixinstall"><span class="std std-ref">Getting required development packages without Nix</span></a>
section for more details.</p>
<p>Otherwise start with following.</p>
<ol class="arabic">
<li><p class="first">Install Nix.
On Linux and Mac OS X, the easiest way to install Nix is to run
the following shell command (as a user other than root):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nixos</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">nix</span><span class="o">/</span><span class="n">install</span> <span class="o">|</span> <span class="n">sh</span>
</pre></div>
</div>
</li>
<li><p class="first">Run Nix shell to get all environment required:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Run from theCore directory</span>
<span class="n">nix</span><span class="o">-</span><span class="n">shell</span> <span class="o">--</span><span class="n">pure</span>
</pre></div>
</div>
</li>
</ol>
<p>From now on, you are ready for creating embedded applications using theCore.</p>
</div>
<div class="section" id="more-info-about-nix">
<h4>More info about Nix<a class="headerlink" href="#more-info-about-nix" title="Permalink to this headline">¶</a></h4>
<p>If you want to get yourself more familiar with Nix, check out <a class="reference external" href="https://www.domenkozar.com/2014/01/02/getting-started-with-nix-package-manager/">the Domenkozar’s blog</a>
or read the <a class="reference external" href="https://nixos.org/nix/manual/">official documentation</a>.</p>
</div>
</div>
<span id="document-guides/hello-world"></span><div class="section" id="creating-your-first-hello-world-application">
<h3>Creating your first Hello World application<a class="headerlink" href="#creating-your-first-hello-world-application" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<span id="document-guides/multiplatform"></span><div class="section" id="multi-platform-application">
<h3>Multi-platform application<a class="headerlink" href="#multi-platform-application" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<span id="document-guides/without-nix"></span><div class="section" id="getting-required-development-packages-without-nix">
<span id="thecore-nonixinstall"></span><h3>Getting required development packages without Nix<a class="headerlink" href="#getting-required-development-packages-without-nix" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
</div>
<span id="document-examples/index"></span><div class="section" id="examples">
<span id="thecore-examples"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<span id="document-examples/hello-world-host"></span><div class="section" id="simple-host-hello-world-example">
<span id="thecore-host-hello"></span><h3>Simple host hello world example<a class="headerlink" href="#simple-host-hello-world-example" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/host_hello</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">host</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">none</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">gcc/g++ v5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">none</td>
</tr>
</tbody>
</table>
<p>This example shows theCore running on the host target.
By <cite>host</cite> target is understood an environment capable to both compile and
run theCore applications.</p>
<p>Application demonstrates a console stream usage and a simple assertion.</p>
<div class="section" id="building">
<h4>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="contents.html#thecore-examples-initial-setup"><span class="std std-ref">Initial setup</span></a> section.</p>
</li>
<li><p class="first">Execute build commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">host_hello</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="running">
<h4>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h4>
<p>Execute resulting application:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">hello</span>
</pre></div>
</div>
</div>
<div class="section" id="expected-output">
<h4>Expected output<a class="headerlink" href="#expected-output" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>Hello, Host World!
This is an assert demonstration. Application will abort.
hello: /home/user/projects/thecore/examples/host_hello/main.cpp:7: int main(): Assertion `1 == 0&#39; failed.
Aborted (core dumped)
</pre></div>
</div>
</div>
<div class="section" id="target-json-for-hello-world-example">
<h4>Target JSON for Hello World example<a class="headerlink" href="#target-json-for-hello-world-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;platform&quot;</span><span class="p">:</span>  <span class="p">{</span> <span class="s2">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="s2">&quot;console&quot;</span><span class="p">:</span> <span class="n">true</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<span id="document-examples/stm32f4-discovery-htu21d-sensor"></span><div class="section" id="stm32f4-discovery-and-htu21d-temperature-and-humidity-sensor">
<h3>STM32F4 discovery and HTU21D temperature and humidity sensor<a class="headerlink" href="#stm32f4-discovery-and-htu21d-temperature-and-humidity-sensor" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/htu21d</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">STM32F4 Discovery board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">UART-to-USB converter attached to the USART2, HTU21D sensor</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">openocd, minicom</td>
</tr>
</tbody>
</table>
<div class="section" id="wiring">
<h4>Wiring<a class="headerlink" href="#wiring" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Connect <a class="reference external" href="https://cdn-shop.adafruit.com/datasheets/1899_HTU21D.pdf">HTU21D</a> to I2C1 on the Discovery board using following pins:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PB6 (I2C1 SCL)</td>
<td>sensor’s SCL</td>
</tr>
<tr class="row-even"><td>PB9 (I2C1 SDA)</td>
<td>sensor’s SDA</td>
</tr>
<tr class="row-odd"><td>+3.3V</td>
<td>sensor’s VDD</td>
</tr>
<tr class="row-even"><td>GND</td>
<td>sensor’s GND</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Attach any preferable UART-to-USB converter <a class="reference external" href="http://www.geekfactory.mx/wp-content/uploads/2013/06/converdidor_usb_ttl_rs232_pl_2303hx_01.jpg">such as this</a> module according to following pinout:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PD8 (USART3 TX)</td>
<td>module’s RX</td>
</tr>
<tr class="row-even"><td>PD9 (USART3 RX)</td>
<td>module’s TX</td>
</tr>
<tr class="row-odd"><td>GND</td>
<td>module’s GND</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Below is the example wiring.</p>
<img alt="_images/htu21d.jpg" src="_images/htu21d.jpg" />
</div>
<div class="section" id="building">
<h4>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="contents.html#thecore-examples-initial-setup"><span class="std std-ref">Initial setup</span></a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">htu21d</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="running">
<h4>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h4>
<p>Firmware will be flashed via <code class="docutils literal"><span class="pre">openocd</span></code> and <code class="docutils literal"><span class="pre">gdb</span></code>.</p>
<ol class="arabic">
<li><p class="first">Connect stm32f4 Discovery board to USB cable and connect USB &lt;-&gt; UART converter to the PC.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">openocd</span></code> in the separate terminal using script provided by theCore.
Alternatively, you can use script from openocd installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">theCore</span>
<span class="n">openocd</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">stm32f4discovery</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with USB &lt;-&gt; UART converter.
(<code class="docutils literal"><span class="pre">/dev/ttyUSB0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB0</span>
</pre></div>
</div>
</li>
<li><p class="first">Provided that your main terminal’s current directory is <code class="docutils literal"><span class="pre">build</span></code>,
launch <code class="docutils literal"><span class="pre">gdb</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From the build directory</span>
<span class="n">arm</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="o">-</span><span class="n">gdb</span> <span class="n">htu21d_example</span>
</pre></div>
</div>
</li>
<li><p class="first">Under GDB shell, connect to <code class="docutils literal"><span class="pre">openocd</span></code> and flash firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>(gdb) target remote :3333
Remote debugging using :3333
0x00000000 in ?? ()

(gdb) monitor reset halt
target state: halted
target halted due to debug-request, current mode: Thread
xPSR: 0x01000000 pc: 0x08000188 msp: 0x20020000

(gdb) load
Loading section .text, size 0x7678 lma 0x8000000
Loading section .data, size 0x3c lma 0x8007678
Start address 0x800477c, load size 30388
Transfer rate: 18 KB/sec, 10129 bytes/write.
</pre></div>
</div>
</li>
<li><p class="first">Start new firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Watch console output.</p>
</li>
</ol>
</div>
<div class="section" id="expected-output">
<h4>Expected output<a class="headerlink" href="#expected-output" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">theCore</span>
<span class="n">Starting</span> <span class="n">HTU21D</span> <span class="n">sensor</span><span class="o">...</span>
<span class="n">Reset</span> <span class="n">done</span>
<span class="n">Temperature</span><span class="p">:</span> <span class="mf">21.722</span> <span class="n">Celsius</span>   <span class="n">Humidity</span><span class="p">:</span> <span class="mf">40.882</span><span class="o">%</span>
<span class="n">Temperature</span><span class="p">:</span> <span class="mf">21.712</span> <span class="n">Celsius</span>   <span class="n">Humidity</span><span class="p">:</span> <span class="mf">40.859</span><span class="o">%</span>
<span class="n">Temperature</span><span class="p">:</span> <span class="mf">21.701</span> <span class="n">Celsius</span>   <span class="n">Humidity</span><span class="p">:</span> <span class="mf">40.852</span><span class="o">%</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="target-json-config-for-the-temperature-and-humidity-example">
<h4>Target JSON config for the temperature and humidity example<a class="headerlink" href="#target-json-config-for-the-temperature-and-humidity-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;stm32&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32F407VG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;console&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bypass_console&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>

        <span class="s2">&quot;clock&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;HSE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">8000000</span>
        <span class="p">},</span>

        <span class="s2">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;baud&quot;</span><span class="p">:</span> <span class="mi">115200</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Bypass and console UART&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>

        <span class="s2">&quot;i2c&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;I2C1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;IRQ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
                <span class="s2">&quot;duty_cycle&quot;</span><span class="p">:</span> <span class="s2">&quot;2/1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ack&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                <span class="s2">&quot;ack_addr_bit&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                <span class="s2">&quot;own_addr&quot;</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;HTU21D I2C&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2c1&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>

        <span class="s2">&quot;pinmux&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;PD8&quot;</span><span class="p">,</span> <span class="s2">&quot;PD9&quot;</span><span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;AF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Console UART: PD8 - RX, PD9 - TX&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;PB6&quot;</span><span class="p">,</span> <span class="s2">&quot;PB9&quot;</span> <span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;AF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;I2C1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;otype&quot;</span><span class="p">:</span> <span class="s2">&quot;OD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pull&quot;</span><span class="p">:</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;HTU21D I2C pins: PB6 - SCL, PB9 - SDA&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<span id="document-examples/stm32f4-discovery-cs43l22"></span><div class="section" id="stm32f4-discovery-audio-example-with-cs43l22-audio-dac">
<span id="thecore-stm32f4-cs43l22"></span><h3>STM32F4 discovery audio example with CS43L22 audio DAC<a class="headerlink" href="#stm32f4-discovery-audio-example-with-cs43l22-audio-dac" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/cs43l22_audio</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">STM32F4 Discovery board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">UART-to-USB converter attached to the USART3, headphones</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">openocd, minicom</td>
</tr>
</tbody>
</table>
<ol class="arabic">
<li><p class="first">Attach any preferable UART-to-USB converter <a class="reference external" href="http://www.geekfactory.mx/wp-content/uploads/2013/06/converdidor_usb_ttl_rs232_pl_2303hx_01.jpg">such as this</a> module according to following pinout:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PD8 (USART3 TX)</td>
<td>module’s RX</td>
</tr>
<tr class="row-even"><td>PD9 (USART3 RX)</td>
<td>module’s TX</td>
</tr>
<tr class="row-odd"><td>GND</td>
<td>module’s GND</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Below is the example wiring.</p>
<img alt="_images/cs43l22_audio.jpg" src="_images/cs43l22_audio.jpg" />
<div class="section" id="building">
<h4>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="contents.html#thecore-examples-initial-setup"><span class="std std-ref">Initial setup</span></a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">cs43l22_audio</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="running">
<h4>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h4>
<p>Firmware will be flashed via <code class="docutils literal"><span class="pre">openocd</span></code> and <code class="docutils literal"><span class="pre">gdb</span></code>.</p>
<ol class="arabic">
<li><p class="first">Connect stm32f4 Discovery board to USB cable and connect USB &lt;-&gt; UART converter to the PC.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">openocd</span></code> in the separate terminal using script provided by theCore.
Alternatively, you can use script from openocd installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">theCore</span>
<span class="n">openocd</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">stm32f4discovery</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with USB &lt;-&gt; UART converter.
(<code class="docutils literal"><span class="pre">/dev/ttyUSB0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB0</span>
</pre></div>
</div>
</li>
<li><p class="first">Provided that your main terminal’s current directory is <code class="docutils literal"><span class="pre">build</span></code>,
launch <code class="docutils literal"><span class="pre">gdb</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From the build directory</span>
<span class="n">arm</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="o">-</span><span class="n">gdb</span> <span class="n">audio</span>
</pre></div>
</div>
</li>
<li><p class="first">Under GDB shell, connect to <code class="docutils literal"><span class="pre">openocd</span></code> and flash firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>(gdb) target remote :3333
Remote debugging using :3333
0x00000000 in ?? ()

(gdb) monitor reset halt
target state: halted
target halted due to debug-request, current mode: Thread
xPSR: 0x01000000 pc: 0x08000188 msp: 0x20020000

(gdb) load
Loading section .text, size 0x4724 lma 0x8000000
Loading section .init_array, size 0xc lma 0x8004724
Loading section .rodata, size 0x228 lma 0x8004730
Loading section .data, size 0x24 lma 0x8004958
Start address 0x8000188, load size 18812
Transfer rate: 14 KB/sec, 3762 bytes/write.
</pre></div>
</div>
</li>
<li><p class="first">Start new firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Attach headphones to the audio jack on Discovery board.</p>
</li>
</ol>
</div>
<div class="section" id="expected-output">
<h4>Expected output<a class="headerlink" href="#expected-output" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">theCore</span>
<span class="n">Playing</span> <span class="n">audio</span> <span class="n">sample</span><span class="o">...</span>
</pre></div>
</div>
<p>In headphones you should hear cool 8-bit sound.</p>
</div>
<div class="section" id="target-json-config-for-the-audio-example">
<h4>Target JSON config for the audio example<a class="headerlink" href="#target-json-config-for-the-audio-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;stm32&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32F407VG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;console&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bypass_console&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clock&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;HSE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">8000000</span>
        <span class="p">},</span>
        <span class="s2">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;baud&quot;</span><span class="p">:</span> <span class="mi">115200</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Bypass and console UART&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;i2c&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;I2C1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;IRQ&quot;</span><span class="p">,</span>
                <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
                <span class="s2">&quot;duty_cycle&quot;</span><span class="p">:</span> <span class="s2">&quot;2/1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ack&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                <span class="s2">&quot;own_addr&quot;</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span>
                <span class="s2">&quot;ack_addr_bit&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;CS43L22 I2C&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2c1&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;dma&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;num&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="s2">&quot;channel&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_tx_dma&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;num&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;stream&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;channel&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_rx_dma&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;i2s&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;I2S3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dma_tx&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_tx_dma&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dma_rx&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_rx_dma&quot;</span><span class="p">,</span>
                <span class="s2">&quot;standard&quot;</span><span class="p">:</span> <span class="s2">&quot;phillips&quot;</span><span class="p">,</span>
                <span class="s2">&quot;data_bits&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                <span class="s2">&quot;master_clk&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                <span class="s2">&quot;audio_freq&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                <span class="s2">&quot;CPOL&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;pinmux&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;PD8&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;PD9&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;AF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Console UART, PD8 - TX, PD9 - RX&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;PC7&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;PC10&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;PC12&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;PA4&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;AF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;SPI3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pull&quot;</span><span class="p">:</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>
                <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="s2">&quot;50MHz&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;CS43L22 I2S&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;PB6&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;PB9&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;AF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;I2C1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;otype&quot;</span><span class="p">:</span> <span class="s2">&quot;OD&quot;</span><span class="p">,</span>
                <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="s2">&quot;50MHz&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pull&quot;</span><span class="p">:</span> <span class="s2">&quot;no&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;CS43L22 I2C&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;PD4&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;OUT&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pull&quot;</span><span class="p">:</span> <span class="s2">&quot;down&quot;</span><span class="p">,</span>
                <span class="s2">&quot;otype&quot;</span><span class="p">:</span> <span class="s2">&quot;PP&quot;</span><span class="p">,</span>
                <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="s2">&quot;50MHz&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;CS43L22 RST&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;gpio_alias&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PD4&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;rst_gpio&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<span id="document-examples/stm32f4-discovery-exti"></span><div class="section" id="stm32f4-discovery-and-external-interrupts-from-user-button">
<h3>STM32F4 discovery and external interrupts from user button<a class="headerlink" href="#stm32f4-discovery-and-external-interrupts-from-user-button" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/stm32f4_exti</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">STM32F4 Discovery board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">UART-to-USB converter attached to the USART3</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">openocd, minicom</td>
</tr>
</tbody>
</table>
<p>EXTI - the external interrupt.</p>
<blockquote>
<div><p>An external interrupt is a computer system interrupt that happens as a result
of outside interference, whether that’s from the user, from peripherals,
from other hardware devices or through a network. These are different
than internal interrupts that happen automatically as the machine
reads through program instructions.</p>
<p class="attribution">&mdash;<a class="reference external" href="https://www.techopedia.com/definition/7115/external-interrupt">Techopedia</a></p>
</div></blockquote>
<p>In this application, one particular type of external interrupt is used:
GPIO line interrupt. When voltage level changes on the line (e.g. when button is
pressed), interrupt is generated.</p>
<div class="section" id="wiring">
<h4>Wiring<a class="headerlink" href="#wiring" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Attach any preferable UART-to-USB converter <a class="reference external" href="http://www.geekfactory.mx/wp-content/uploads/2013/06/converdidor_usb_ttl_rs232_pl_2303hx_01.jpg">such as this</a> module according to following pinout:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PD8 (USART3 TX)</td>
<td>module’s RX</td>
</tr>
<tr class="row-even"><td>PD9 (USART3 RX)</td>
<td>module’s TX</td>
</tr>
<tr class="row-odd"><td>GND</td>
<td>module’s GND</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Below is the example wiring.</p>
<img alt="_images/stm32f4_exti.jpg" src="_images/stm32f4_exti.jpg" />
</div>
<div class="section" id="building">
<h4>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="contents.html#thecore-examples-initial-setup"><span class="std std-ref">Initial setup</span></a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">stm32f4_exti</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="running">
<h4>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h4>
<p>Firmware will be flashed via <code class="docutils literal"><span class="pre">openocd</span></code> and <code class="docutils literal"><span class="pre">gdb</span></code>.</p>
<ol class="arabic">
<li><p class="first">Connect stm32f4 Discovery board to USB cable and connect USB &lt;-&gt; UART converter to the PC.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">openocd</span></code> in the separate terminal using script provided by theCore.
Alternatively, you can use script from openocd installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">theCore</span>
<span class="n">openocd</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">stm32f4discovery</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with USB &lt;-&gt; UART converter.
(<code class="docutils literal"><span class="pre">/dev/ttyUSB0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB0</span>
</pre></div>
</div>
</li>
<li><p class="first">Provided that your main terminal’s current directory is <code class="docutils literal"><span class="pre">build</span></code>,
launch <code class="docutils literal"><span class="pre">gdb</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From the build directory</span>
<span class="n">arm</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="o">-</span><span class="n">gdb</span> <span class="n">exti</span>
</pre></div>
</div>
</li>
<li><p class="first">Under GDB shell, connect to <code class="docutils literal"><span class="pre">openocd</span></code> and flash firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>(gdb) target remote :3333
Remote debugging using :3333
0x00000000 in ?? ()

(gdb) monitor reset halt
target state: halted
target halted due to debug-request, current mode: Thread
xPSR: 0x01000000 pc: 0x08000188 msp: 0x20020000

(gdb) load
Loading section .text, size 0x4724 lma 0x8000000
Loading section .init_array, size 0xc lma 0x8004724
Loading section .rodata, size 0x228 lma 0x8004730
Loading section .data, size 0x24 lma 0x8004958
Start address 0x8000188, load size 18812
Transfer rate: 14 KB/sec, 3762 bytes/write.
</pre></div>
</div>
</li>
<li><p class="first">Start new firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Press blue user button on the Discovery board and observe output in <code class="docutils literal"><span class="pre">minicom</span></code>.</p>
</li>
</ol>
</div>
<div class="section" id="expected-output">
<h4>Expected output<a class="headerlink" href="#expected-output" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<ul>
<li><p class="first">Before button press:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Welcome to theCore
Hello, Embedded World!
</pre></div>
</div>
</li>
<li><p class="first">After each button press:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Button pressed!
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="target-json-config-for-the-exti-example">
<h4>Target JSON config for the EXTI example<a class="headerlink" href="#target-json-config-for-the-exti-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;stm32&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32F407VG&quot;</span><span class="p">,</span>
        <span class="s2">&quot;console&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bypass_console&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
        <span class="s2">&quot;clock&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;HSE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">8000000</span>
        <span class="p">},</span>
        <span class="s2">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;baud&quot;</span><span class="p">:</span> <span class="mi">115200</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Bypass and console UART&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;pinmux&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;PD8&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;PD9&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;AF&quot;</span><span class="p">,</span>
                <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Console UART&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;PA0&quot;</span>
                <span class="p">],</span>
                <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;IN&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Push button&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;gpio_alias&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PA0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;usr_btn&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<span id="document-examples/stm32f4-discovery-blink"></span><div class="section" id="stm32f4-discovery-blinky-project">
<h3>STM32F4 discovery blinky project<a class="headerlink" href="#stm32f4-discovery-blinky-project" title="Permalink to this headline">¶</a></h3>
<p>The example runs on Discovery kit with STM32F407VG MCU and demonstrates
simple project that uses onboard LEDs.</p>
<p>Refer to <a class="reference external" href="https://github.com/forGGe/theCore-blinky">the dedicated repository</a> to check how to build and run the example.</p>
</div>
<span id="document-examples/ti-tm4c123g-launchpad-blink"></span><div class="section" id="ti-tm4c123g-launchpad-blinky">
<h3>TI TM4C123G LaunchPad blinky<a class="headerlink" href="#ti-tm4c123g-launchpad-blinky" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/tm4c_led</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">Tiva C Series TM4C123G LaunchPadEvaluation Board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">none</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">UniFlash, minicom</td>
</tr>
</tbody>
</table>
<div class="section" id="wiring">
<h4>Wiring<a class="headerlink" href="#wiring" title="Permalink to this headline">¶</a></h4>
<p>No special wiring is required. Just connect the board to the powered USB port.</p>
<p>Below is the board image showing simple USB connection.</p>
<img alt="_images/tm4c_led.jpg" src="_images/tm4c_led.jpg" />
</div>
<div class="section" id="building">
<h4>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="contents.html#thecore-examples-initial-setup"><span class="std std-ref">Initial setup</span></a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="running">
<h4>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Flash firmware via <a class="reference external" href="http://processors.wiki.ti.com/index.php/Category:CCS_UniFlash">UniFlash</a>. The UniFlash interface is straightforward.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with the board.
(<code class="docutils literal"><span class="pre">/dev/ttyACM0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="expected-output">
<h4>Expected output<a class="headerlink" href="#expected-output" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">theCore</span>
<span class="n">Starting</span> <span class="n">TM4C</span> <span class="n">led</span> <span class="n">demo</span><span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="target-json-config-for-the-tm4c-led-example">
<h4>Target JSON config for the TM4C LED example<a class="headerlink" href="#target-json-config-for-the-tm4c-led-example" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;TM4C123GH6PM&quot;</span><span class="p">,</span>
        <span class="s2">&quot;console&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;UART-over-USB console output&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;pinmux&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;PF1&quot;</span><span class="p">,</span> <span class="s2">&quot;PF2&quot;</span><span class="p">,</span> <span class="s2">&quot;PF3&quot;</span> <span class="p">],</span>
                <span class="s2">&quot;dir&quot;</span><span class="p">:</span> <span class="s2">&quot;out&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pin_type&quot;</span><span class="p">:</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span>
                <span class="s2">&quot;strength&quot;</span><span class="p">:</span> <span class="s2">&quot;2mA&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;LED pins&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;PA0&quot;</span><span class="p">,</span> <span class="s2">&quot;PA1&quot;</span> <span class="p">],</span>
                <span class="s2">&quot;dir&quot;</span><span class="p">:</span> <span class="s2">&quot;hw&quot;</span><span class="p">,</span>
                <span class="s2">&quot;hws&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;PA0&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0_RX&quot;</span><span class="p">,</span> <span class="s2">&quot;PA1&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0_TX&quot;</span> <span class="p">},</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0 console pins&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;gpio_alias&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PF1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;led_red&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Red LED&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PF2&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;led_blue&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Blue LED&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PF3&quot;</span><span class="p">,</span>
                <span class="s2">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;led_green&quot;</span><span class="p">,</span>
                <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Green LED&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>On-board LED will blink with the different (RGB) colors.</p>
</div>
</div>
</div>
<p>theCore examples are organized in a form of separate projects that can be
extracted and used as a base for custom application.</p>
<p>Examples are of two types. First is standalone example, placed in
the separate repository for convenience. For such, in each section you will
find a reference to the project location. Second type of examples are in-source
examples, placed under <code class="docutils literal"><span class="pre">examples</span></code> directory within theCore source tree.</p>
<div class="section" id="initial-setup">
<span id="thecore-examples-initial-setup"></span><h3>Initial setup<a class="headerlink" href="#initial-setup" title="Permalink to this headline">¶</a></h3>
<p>Before any example can be built, an appropriate development environment must
be configured either manually by installing packages like toolchains or
by using Nix.</p>
<p>Using Nix is recommended. The <a class="reference internal" href="contents.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> section contains
the explanation about how to install and run Nix.</p>
<p>To manually install required software without Nix (not recommended),
refer to <a class="reference internal" href="contents.html#thecore-nonixinstall"><span class="std std-ref">Getting required development packages without Nix</span></a> section.
There you will find some insights about getting hand-made development environment.</p>
</div>
</div>
<span id="document-project_structure"></span><div class="section" id="project-structure">
<h2>Project structure<a class="headerlink" href="#project-structure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="top-level-directories">
<h3>Top-level directories<a class="headerlink" href="#top-level-directories" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="exported-headers">
<h3>Exported headers<a class="headerlink" href="#exported-headers" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="build-system">
<h3>Build system<a class="headerlink" href="#build-system" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-arch"></span><div class="section" id="supported-architectures">
<h2>Supported architectures<a class="headerlink" href="#supported-architectures" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
<div class="section" id="cortex-m3-and-m4">
<h3>Cortex M3 and M4<a class="headerlink" href="#cortex-m3-and-m4" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="host">
<h3>Host<a class="headerlink" href="#host" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-platform/index"></span><div class="section" id="supported-platforms">
<span id="thecore-platforms"></span><h2>Supported platforms<a class="headerlink" href="#supported-platforms" title="Permalink to this headline">¶</a></h2>
<p>For the list supported by theCore platform navigate below.</p>
<div class="toctree-wrapper compound">
<span id="document-platform/stm32"></span><div class="section" id="stm32">
<span id="thecore-stm32"></span><h3>STM32<a class="headerlink" href="#stm32" title="Permalink to this headline">¶</a></h3>
<p>The STM32 is a family of 32-bit Flash microcontrollers based on the
ARM Cortex-M processor. theCore supports two families of STM32: STM32F4 and STM32L1</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The platform is configured by theCore configurator.
To make sure you are familiar with it, check the <a class="reference internal" href="contents.html#thecore-configurator"><span class="std std-ref">JSON-based configurator</span></a>
section before going any further.</p>
</div>
<p>Minimal configuration JSON file for the STM32 MCU must contain the platform
object with following fields:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">name</span></code> - platform name (simply <code class="docutils literal"><span class="pre">stm32</span></code>)</li>
<li><code class="docutils literal"><span class="pre">device</span></code> - desired device ID. Depends on MCU.</li>
<li><code class="docutils literal"><span class="pre">clock</span></code> - the clock configuration:<ul>
<li><code class="docutils literal"><span class="pre">source</span></code> - the clock source. Depends on board capabilities and MCU.</li>
<li><code class="docutils literal"><span class="pre">speed</span></code> - the clock speed in Hz.</li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Currently, only <code class="docutils literal"><span class="pre">HSE</span></code> clock source is supported.</p>
</div>
<p>For example, STM32F4 Discovery board the basic configuration can look like that:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
     <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;stm32&quot;</span><span class="p">,</span>
         <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32F407VG&quot;</span><span class="p">,</span>
         <span class="nt">&quot;clock&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;HSE&quot;</span><span class="p">,</span>
             <span class="nt">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">8000000</span>
         <span class="p">}</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>To import all generated definitions into the application code, simply add following
line to your source:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;aux/generated.hpp&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p>For more JSON configuration examples for STM32 platform, refer to
the <a class="reference internal" href="contents.html#thecore-examples"><span class="std std-ref">Examples</span></a> page.</p>
<p>Following sections provide in-depth description of peripheral configuration.
Arm yourself with the Reference Manual from ST before going any further.</p>
<div class="admonition hint" id="stm32-rm">
<p class="first admonition-title">Hint</p>
<p>Hereinafter <strong>RM</strong> stands for <em>Reference Manual</em> from MCU vendor.
Note that some STM32 families has more than one RM per family.
Pick appropriate, based on your concrete MCU model.
Below are links to RMs for each supported family.</p>
<ul class="last simple">
<li><a class="reference external" href="https://goo.gl/Xn1DRB">STM32F4 RM</a></li>
<li><a class="reference external" href="https://goo.gl/sML2mi">STM32L1 RM</a></li>
</ul>
</div>
<div class="section" id="periphery-overview">
<h4>Periphery overview<a class="headerlink" href="#periphery-overview" title="Permalink to this headline">¶</a></h4>
<p>STM32 MCU peripheries, can be configured within the same JSON file.
Layout of the platform configuration object is described by JSON schema,
placed under <code class="docutils literal"><span class="pre">platform/stm32/schemas/stm32.schema.json</span></code>:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;oneOf&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32F4 schema&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
            <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;STM32F407VG&quot;</span> <span class="p">]</span> <span class="p">},</span>
                <span class="nt">&quot;dma&quot;</span><span class="p">:</span>    <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:../family/f4xx/schemas/dma.schema.json&quot;</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32L1 schema&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
            <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;STM32L152RE&quot;</span> <span class="p">]</span> <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">],</span>

    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span>           <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^stm32$&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;clock&quot;</span><span class="p">:</span>          <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:clock.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;uart&quot;</span><span class="p">:</span>           <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:uart.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;adc&quot;</span><span class="p">:</span>            <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:adc.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;adc_channels&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:adc_channels.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;i2c&quot;</span><span class="p">:</span>            <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:i2c.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;i2s&quot;</span><span class="p">:</span>            <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:i2s.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;pinmux&quot;</span><span class="p">:</span>         <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:pinmux.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;gpio_alias&quot;</span><span class="p">:</span>     <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:gpio_alias.schema.json&quot;</span> <span class="p">}</span>
    <span class="p">},</span>

    <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;clock&quot;</span><span class="p">,</span> <span class="s2">&quot;device&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Each periphery configuration placed under a property with a relevant name.
The example below illustrates UART periphery being added to JSON config:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="p">{</span>
     <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;stm32&quot;</span><span class="p">,</span>
         <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32F407VG&quot;</span><span class="p">,</span>
         <span class="nt">&quot;clock&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;HSE&quot;</span><span class="p">,</span>
             <span class="nt">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">8000000</span>
         <span class="p">},</span>
<span class="hll">         <span class="nt">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class="hll">             <span class="p">{</span>
</span><span class="hll">                 <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
</span><span class="hll">                 <span class="nt">&quot;baud&quot;</span><span class="p">:</span> <span class="mi">115200</span><span class="p">,</span>
</span><span class="hll">                 <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;test_uart&quot;</span>
</span><span class="hll">             <span class="p">}</span>
</span><span class="hll">         <span class="p">]</span>
</span>     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Note that to use any of periphery, corresponding pins must be configured too.
<strong>Do not forget to include pin multiplexing configuration for each desired periphery.</strong>
Proceed to the <a class="reference internal" href="#stm32-multiplexing">STM32 Multiplexing</a> for more details.</p>
</div>
<div class="section" id="timer-allocation">
<h4>Timer allocation<a class="headerlink" href="#timer-allocation" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
<div class="section" id="u-s-art">
<h4>U(S)ART<a class="headerlink" href="#u-s-art" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver source:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/export/aux/usart_bus.hpp</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Template file:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/templates/uart_cfg.in.hpp</span></code></td>
</tr>
</tbody>
</table>
<p>The instance of the driver, generated during the configuration step, can
be used directly by its API or indirectly, as underlying device for theCore
console.</p>
<p>Check <a class="reference internal" href="#stm32-console"><span class="std std-ref">the console configuration section</span></a> to get
information about selecting particular UART as a console output.</p>
<p>STM32 theCore UART supports only IRQ mode, where interrupt is generated after
each byte transmission. DMA mode is not yet implemented.</p>
<div class="section" id="json-schema">
<h5>JSON schema<a class="headerlink" href="#json-schema" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>

    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^US?ART\\d$&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;baud&quot;</span><span class="p">:</span>    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;alias&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">},</span>

        <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;id&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="properties">
<h5>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">id</span></code> - UART periphery ID, named after identifier found in <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a>.
Examples are: <code class="docutils literal"><span class="pre">UART1</span></code> or <code class="docutils literal"><span class="pre">USART4</span></code>. Depends on MCU family.</li>
<li><code class="docutils literal"><span class="pre">baud</span></code> - desired baud rate of the selected UART.</li>
<li><code class="docutils literal"><span class="pre">alias</span></code> - user-defined typename, which can be used as a reference to an
concrete UART driver instance, both in configuration JSON and C++.
Must be valid C++ identifier. See <a class="reference internal" href="#stm32-uart-example"><span class="std std-ref">the UART example</span></a>
below for more details.</li>
<li><code class="docutils literal"><span class="pre">comment</span></code> - user-defined string, describes driver purpose. Must be valid
string, suitable for C/C++ comments.</li>
</ul>
</div>
<div class="section" id="example-configuration">
<span id="stm32-uart-example"></span><h5>Example configuration<a class="headerlink" href="#example-configuration" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;USART3&quot;</span><span class="p">,</span>
                <span class="nt">&quot;baud&quot;</span><span class="p">:</span> <span class="mi">115200</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Console UART&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;console_uart&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;UART1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;baud&quot;</span><span class="p">:</span> <span class="mi">9600</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Just another driver&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;my_uart&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="example-output-for-stm32f4-family">
<h5>Example output for STM32F4 family<a class="headerlink" href="#example-output-for-stm32f4-family" title="Permalink to this headline">¶</a></h5>
<p>User-defined aliases are highlighted.</p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>

<span class="c1">// UART configuration ---------------------------------------------------------</span>


<span class="cm">/* Console UART */</span>

<span class="k">template</span><span class="o">&lt;&gt;</span>
<span class="k">struct</span> <span class="n">usart_cfg</span><span class="o">&lt;</span><span class="n">usart_device</span><span class="o">::</span><span class="n">dev3</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">baudrate</span>  <span class="o">=</span> <span class="mi">115200</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">word_len</span>  <span class="o">=</span> <span class="n">USART_WordLength_8b</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">stop_bit</span>  <span class="o">=</span> <span class="n">USART_StopBits_1</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">parity</span>    <span class="o">=</span> <span class="n">USART_Parity_No</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">mode</span>      <span class="o">=</span> <span class="n">USART_Mode_Rx</span> <span class="o">|</span> <span class="n">USART_Mode_Tx</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">hw_flow</span>   <span class="o">=</span> <span class="n">USART_HardwareFlowControl_None</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">USART3_cfg</span> <span class="o">=</span> <span class="n">usart_cfg</span><span class="o">&lt;</span><span class="n">usart_device</span><span class="o">::</span><span class="n">dev3</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">USART3_driver</span> <span class="o">=</span> <span class="n">usart_bus</span><span class="o">&lt;</span><span class="n">usart_device</span><span class="o">::</span><span class="n">dev3</span><span class="o">&gt;</span><span class="p">;</span>
<span class="hll"><span class="k">using</span> <span class="n">console_uart</span> <span class="o">=</span> <span class="n">USART3_driver</span><span class="p">;</span>
</span>
<span class="cm">/* Just another driver */</span>

<span class="k">template</span><span class="o">&lt;&gt;</span>
<span class="k">struct</span> <span class="n">usart_cfg</span><span class="o">&lt;</span><span class="n">usart_device</span><span class="o">::</span><span class="n">dev1</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">baudrate</span>  <span class="o">=</span> <span class="mi">9600</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">word_len</span>  <span class="o">=</span> <span class="n">USART_WordLength_8b</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">stop_bit</span>  <span class="o">=</span> <span class="n">USART_StopBits_1</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">parity</span>    <span class="o">=</span> <span class="n">USART_Parity_No</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">mode</span>      <span class="o">=</span> <span class="n">USART_Mode_Rx</span> <span class="o">|</span> <span class="n">USART_Mode_Tx</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">auto</span> <span class="k">constexpr</span> <span class="n">hw_flow</span>   <span class="o">=</span> <span class="n">USART_HardwareFlowControl_None</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">UART1_cfg</span> <span class="o">=</span> <span class="n">usart_cfg</span><span class="o">&lt;</span><span class="n">usart_device</span><span class="o">::</span><span class="n">dev1</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">UART1_driver</span> <span class="o">=</span> <span class="n">usart_bus</span><span class="o">&lt;</span><span class="n">usart_device</span><span class="o">::</span><span class="n">dev1</span><span class="o">&gt;</span><span class="p">;</span>
<span class="hll"><span class="k">using</span> <span class="n">my_uart</span> <span class="o">=</span> <span class="n">UART1_driver</span><span class="p">;</span>
</span>
<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="../_static/generated/stm32/uart_example.hpp">Full STM32 UART example header</a></p>
</div>
<div class="section" id="usage">
<h5>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<div class="section" id="adc-and-channels">
<h4>ADC and channels<a class="headerlink" href="#adc-and-channels" title="Permalink to this headline">¶</a></h4>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">ADC was tested only with STM32F4 family.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver sources:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/export/aux/adc.hpp</span></code>
<code class="docutils literal"><span class="pre">platform/stm32/family/f4xx/export/stm32f4xx_adc_wrap.hpp</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Template file:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/templates/adc_cfg.in.hpp</span></code></td>
</tr>
</tbody>
</table>
<p>ADC configuration split onto two entities. First is configuration of the ADC
itself, second is the configuration for particular channels. In such way,
it is possible to have different set of ADC channels used with the same ADC.</p>
<div class="section" id="adc-schema">
<h5>ADC schema<a class="headerlink" href="#adc-schema" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>

    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^ADC\\d$&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;mode&quot;</span><span class="p">:</span>    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;IRQ&quot;</span><span class="p">,</span> <span class="s2">&quot;DMA&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;dma_id&quot;</span><span class="p">:</span>  <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;alias&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">},</span>

        <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;id&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id1">
<h5>Properties<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">id</span></code> - ADC periphery ID, named after identifier found in <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a>.
Examples are: <code class="docutils literal"><span class="pre">ADC1</span></code> or <code class="docutils literal"><span class="pre">ADC2</span></code>.
Depends on MCU family. See <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a> to get valid ID.</li>
<li><code class="docutils literal"><span class="pre">mode</span></code> - desired mode of operation. Can be either <code class="docutils literal"><span class="pre">DMA</span></code> or <code class="docutils literal"><span class="pre">IRQ</span></code>.
Mode affects how conversions are managed. In DMA mode, conversions are
handled by DMA and interrupt is generated when conversion is finished
or when half of channels are converted.
In IRQ mode, each channel conversion produces interrupt.</li>
<li><code class="docutils literal"><span class="pre">alias</span></code> - user-defined typename, which can be used as a reference to an
concrete UART driver instance, both in configuration JSON and C++.
Must be valid C++ identifier. See <a class="reference internal" href="#stm32-uart-example"><span class="std std-ref">the configuration example</span></a>
below for more details.</li>
<li><code class="docutils literal"><span class="pre">comment</span></code> - user-defined string, describes driver purpose. Must be valid
string, suitable for C/C++ comments.</li>
</ul>
</div>
<div class="section" id="channels-schema">
<h5>Channels schema<a class="headerlink" href="#channels-schema" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>

    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;trigger&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="s2">&quot;SW&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;nums&quot;</span><span class="p">:</span>    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span> <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span> <span class="p">}</span> <span class="p">},</span>
            <span class="nt">&quot;alias&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">trigger</span></code> - trigger to start conversion on selected channels:<ul>
<li><code class="docutils literal"><span class="pre">SW</span></code> - software trigger. Only trigger supported at this moment.</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">nums</span></code> - array with channel numbers. Refer to <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a> to get
possible channels and their mapping.</li>
<li><code class="docutils literal"><span class="pre">alias</span></code> - user-defined typename, which can be used as a reference to an
channel set in C++. Must be valid C++ identifier.</li>
<li><code class="docutils literal"><span class="pre">comment</span></code> - user-defined string, describes driver purpose. Must be valid
string, suitable for C/C++ comments.</li>
</ul>
</div>
<div class="section" id="example-configuration-irq-mode">
<h5>Example configuration (IRQ mode)<a class="headerlink" href="#example-configuration-irq-mode" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;adc&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;ADC1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;DMA&quot;</span><span class="p">,</span>
                <span class="nt">&quot;dma_id&quot;</span><span class="p">:</span> <span class="s2">&quot;adc_dma&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;example_adc&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Example ADC device&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;adc_channels&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;trigger&quot;</span><span class="p">:</span> <span class="s2">&quot;SW&quot;</span><span class="p">,</span>
                <span class="nt">&quot;nums&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mi">1</span><span class="p">,</span>
                    <span class="mi">16</span>
                <span class="p">],</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;test_channels&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;PA1 pin and the temperature channel&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id2">
<h5>Example output for STM32F4 family<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>


<span class="c1">// ADC configuration -----------------------------------------------------------</span>

<span class="cm">/* Example ADC device */</span>


<span class="k">template</span><span class="o">&lt;&gt;</span>
<span class="k">struct</span> <span class="n">adc_cfg</span><span class="o">&lt;</span><span class="n">adc_dev</span><span class="o">::</span><span class="n">dev1</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="n">adc_mgmt_mode</span> <span class="n">mgtm_mode</span> <span class="o">=</span> <span class="n">adc_mgmt_mode</span><span class="o">::</span><span class="n">dma</span><span class="p">;</span>

    <span class="k">using</span> <span class="n">dma</span> <span class="o">=</span> <span class="n">adc_dma</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">ADC1_driver</span> <span class="o">=</span> <span class="n">adc</span><span class="o">&lt;</span><span class="n">adc_dev</span><span class="o">::</span><span class="n">dev1</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">example_adc</span> <span class="o">=</span> <span class="n">ADC1_driver</span><span class="p">;</span>

<span class="c1">// ADC channels configuration --------------------------------------------------</span>

<span class="cm">/* PA1 pin and the temperature channel */</span>


<span class="k">using</span> <span class="n">test_channels</span> <span class="o">=</span> <span class="n">channel_group_sw_trigger</span><span class="o">&lt;</span><span class="n">adc_channel</span><span class="o">::</span><span class="n">ch1</span><span class="p">,</span> <span class="n">adc_channel</span><span class="o">::</span><span class="n">ch16</span><span class="o">&gt;</span><span class="p">;</span>


<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="../_static/generated/stm32/adc_example.hpp">Full STM32 ADC example header</a></p>
</div>
<div class="section" id="id3">
<h5>Usage<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<div class="section" id="i2c">
<h4>I2C<a class="headerlink" href="#i2c" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver source:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/export/aux/i2c_bus.hpp</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Template file:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/templates/i2c_cfg.in.hpp</span></code></td>
</tr>
</tbody>
</table>
<div class="section" id="id4">
<h5>JSON schema<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>

    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span>           <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^I2C\\d$&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;mode&quot;</span><span class="p">:</span>         <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;IRQ&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;speed&quot;</span><span class="p">:</span>        <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;duty_cycle&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;2/1&quot;</span><span class="p">,</span> <span class="s2">&quot;16/9&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;ack&quot;</span><span class="p">:</span>          <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;ack_addr_bit&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;own_addr&quot;</span><span class="p">:</span>     <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;alias&quot;</span><span class="p">:</span>        <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">},</span>

        <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;id&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id5">
<h5>Properties<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">id</span></code> - I2C periphery ID, named after identifier found in <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a>.
Examples are: <code class="docutils literal"><span class="pre">I2C1</span></code> or <code class="docutils literal"><span class="pre">I2C2</span></code>.
Depends on MCU family. See <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a> to get valid ID.</li>
<li><code class="docutils literal"><span class="pre">mode</span></code> - data transfer mode. Only <code class="docutils literal"><span class="pre">IRQ</span></code> is supported. In IRQ mode, each
byte transfer results in interrupt generation. The software driver responds
to such interrupt with requesting next byte transmission.</li>
<li><code class="docutils literal"><span class="pre">speed</span></code> - specifies the clock frequency in Hz. Refer to the <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a>
to check clock speed limitations.</li>
<li><code class="docutils literal"><span class="pre">duty_cycle</span></code> - duty cycle of selected I2C bus
(ratio of T<sub>low</sub> /T<sub>high</sub> ). Can be either <code class="docutils literal"><span class="pre">2/1</span></code> or <code class="docutils literal"><span class="pre">16/9</span></code>.</li>
<li><code class="docutils literal"><span class="pre">ack</span></code> - enables or disables the acknowledgement.</li>
<li><code class="docutils literal"><span class="pre">ack_addr_bit</span></code> - specifies if 7-bit or 10-bit address is acknowledged.</li>
<li><code class="docutils literal"><span class="pre">own_addr</span></code> - specifies the first device own address.</li>
<li><code class="docutils literal"><span class="pre">alias</span></code> - user-defined typename, which can be used as a reference to I2C
driver instance in C++. Must be valid C++ identifier.</li>
<li><code class="docutils literal"><span class="pre">comment</span></code> - user-defined string, describes a driver purpose. Must be valid
string, suitable for C/C++ comments.</li>
</ul>
<p>Example configuration:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;i2c&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;I2C1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;IRQ&quot;</span><span class="p">,</span>
                <span class="nt">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
                <span class="nt">&quot;duty_cycle&quot;</span><span class="p">:</span> <span class="s2">&quot;2/1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;ack&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nt">&quot;ack_addr_bit&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                <span class="nt">&quot;own_addr&quot;</span><span class="p">:</span> <span class="mi">51</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Just another I2C bus&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2c1&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Example output:</p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>

<span class="c1">// I2C configuration -----------------------------------------------------------</span>

<span class="cm">/* Just another I2C bus */</span>

<span class="k">using</span> <span class="n">I2C1_driver_cfg</span> <span class="o">=</span> <span class="n">i2c_config</span><span class="o">&lt;</span>
    <span class="n">i2c_device</span><span class="o">::</span><span class="n">bus1</span><span class="p">,</span>
    <span class="n">i2c_mode</span><span class="o">::</span><span class="n">IRQ</span><span class="p">,</span>
    <span class="mi">1000</span><span class="p">,</span>
    <span class="n">I2C_Mode_I2C</span><span class="p">,</span>
    <span class="n">I2C_DutyCycle_2</span><span class="p">,</span>
    <span class="mi">51</span><span class="p">,</span>
    <span class="n">I2C_Ack_Enable</span><span class="p">,</span>
    <span class="n">I2C_AcknowledgedAddress_7bit</span>
<span class="o">&gt;</span><span class="p">;</span>

<span class="k">using</span> <span class="n">I2C1_driver</span> <span class="o">=</span> <span class="n">i2c_bus</span><span class="o">&lt;</span><span class="n">I2C1_driver_cfg</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">i2c1</span> <span class="o">=</span> <span class="n">I2C1_driver</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="../_static/generated/stm32/i2c_example.hpp">Full STM32 I2C example header</a></p>
</div>
<div class="section" id="id6">
<h5>Usage<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<div class="section" id="i2s">
<h4>I2S<a class="headerlink" href="#i2s" title="Permalink to this headline">¶</a></h4>
<div class="section" id="id7">
<h5>JSON schema<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>

    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span>          <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^I2S\\d$&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;dma_tx&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;dma_rx&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;standard&quot;</span><span class="p">:</span>    <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;phillips&quot;</span><span class="p">,</span> <span class="s2">&quot;MSB&quot;</span><span class="p">,</span> <span class="s2">&quot;LSB&quot;</span><span class="p">,</span> <span class="s2">&quot;PCMShort&quot;</span><span class="p">,</span> <span class="s2">&quot;PCMLong&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;data_bits&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;16ext&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;audio_freq&quot;</span><span class="p">:</span>  <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">192</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;CPOL&quot;</span><span class="p">:</span>        <span class="p">{</span> <span class="nt">&quot;enum&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;alias&quot;</span><span class="p">:</span>       <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">},</span>

        <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;id&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id8">
<h5>Properties<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">id</span></code> - I2S periphery ID, named after identifier found in <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a>.
Examples are: <code class="docutils literal"><span class="pre">I2S</span></code> or <code class="docutils literal"><span class="pre">I2S</span></code>.
Depends on MCU family. See <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a> to get valid ID.</li>
<li><code class="docutils literal"><span class="pre">dma_tx</span></code> - DMA id to use for TX transactions. See <a class="reference internal" href="#stm32-i2s-example"><span class="std std-ref">the configuration example</span></a>
and the <a class="reference internal" href="#stm32-dma"><span class="std std-ref">DMA</span></a> section for more details.</li>
<li><code class="docutils literal"><span class="pre">dma_rx</span></code> - DMA id to use for RX transactions. See <a class="reference internal" href="#stm32-i2s-example"><span class="std std-ref">the configuration example</span></a>
and the <a class="reference internal" href="#stm32-dma"><span class="std std-ref">DMA</span></a> section for more details.</li>
<li><code class="docutils literal"><span class="pre">standart</span></code> - specifies the standard used for the I2S communication. Allowed values are:
<code class="docutils literal"><span class="pre">phillips</span></code>, <code class="docutils literal"><span class="pre">MSB</span></code>, <code class="docutils literal"><span class="pre">LSB</span></code>, <code class="docutils literal"><span class="pre">PCMShort</span></code>, <code class="docutils literal"><span class="pre">PCMLong</span></code>. Refer to <a class="reference internal" href="#stm32-rm"><span class="std std-ref">Reference Manual</span></a>
to get explanation about each.</li>
<li><code class="docutils literal"><span class="pre">data_bits</span></code> - specifies the data format for the I2S communication.</li>
<li><code class="docutils literal"><span class="pre">master_clk</span></code> - specifies whether the I2S MCLK output is enabled or not.</li>
<li><code class="docutils literal"><span class="pre">audio_freq</span></code> - specifies the frequency selected for the I2S communication.</li>
<li><code class="docutils literal"><span class="pre">CPOL</span></code> - specifies the idle state of the I2S clock.</li>
<li><code class="docutils literal"><span class="pre">alias</span></code> - user-defined typename, which can be used as a reference to I2S
driver instance in C++. Must be valid C++ identifier.</li>
<li><code class="docutils literal"><span class="pre">comment</span></code> - user-defined string, describes a driver purpose. Must be valid
string, suitable for C/C++ comments.</li>
</ul>
</div>
<div class="section" id="stm32-i2s-example">
<span id="id9"></span><h5>Example configuration<a class="headerlink" href="#stm32-i2s-example" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;dma&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;num&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;stream&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="nt">&quot;channel&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="hll">                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_tx_dma&quot;</span>
</span>            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;num&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;stream&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;channel&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="hll">                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_rx_dma&quot;</span>
</span>            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;i2s&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;I2S3&quot;</span><span class="p">,</span>
<span class="hll">                <span class="nt">&quot;dma_tx&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_tx_dma&quot;</span><span class="p">,</span>
</span><span class="hll">                <span class="nt">&quot;dma_rx&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_rx_dma&quot;</span><span class="p">,</span>
</span>                <span class="nt">&quot;standard&quot;</span><span class="p">:</span> <span class="s2">&quot;phillips&quot;</span><span class="p">,</span>
                <span class="nt">&quot;data_bits&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                <span class="nt">&quot;master_clk&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                <span class="nt">&quot;audio_freq&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                <span class="nt">&quot;CPOL&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;the_i2s3_alias&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>DMA aliases and their usage in I2S config are highlighted.</p>
<p>Example output (<strong>DMA configuration header is omitted for clarity</strong>):</p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// I2S configuration -----------------------------------------------------------</span>


<span class="k">template</span><span class="o">&lt;&gt;</span>
<span class="k">struct</span> <span class="n">spi_i2s_cfg</span><span class="o">&lt;</span><span class="n">spi_device</span><span class="o">::</span><span class="n">bus3</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="k">auto</span> <span class="n">bus_type</span> <span class="o">=</span> <span class="n">spi_bus_type</span><span class="o">::</span><span class="n">i2s</span><span class="p">;</span>

    <span class="k">using</span> <span class="n">dma_tx</span> <span class="o">=</span> <span class="n">i2s3_tx_dma</span><span class="p">;</span>
    <span class="k">using</span> <span class="n">dma_rx</span> <span class="o">=</span> <span class="n">i2s3_rx_dma</span><span class="p">;</span>

    <span class="k">static</span> <span class="k">constexpr</span> <span class="n">I2S_InitTypeDef</span> <span class="n">init_obj</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">I2S_Mode_MasterTx</span><span class="p">,</span>
        <span class="n">I2S_Standard_Phillips</span><span class="p">,</span>
        <span class="n">I2S_DataFormat_16b</span><span class="p">,</span>
        <span class="n">I2S_MCLKOutput_Enable</span><span class="p">,</span>
        <span class="n">I2S_AudioFreq_8k</span><span class="p">,</span>
        <span class="n">I2S_CPOL_High</span><span class="p">,</span>
    <span class="p">};</span>
<span class="p">};</span>


<span class="k">using</span> <span class="n">I2S3_driver</span> <span class="o">=</span> <span class="n">spi_i2s_bus</span><span class="o">&lt;</span><span class="n">spi_device</span><span class="o">::</span><span class="n">bus3</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">the_i2s3_alias</span> <span class="o">=</span> <span class="n">I2S3_driver</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="../_static/generated/stm32/i2s_example.hpp">Full STM32 I2S example header</a></p>
</div>
<div class="section" id="id10">
<h5>Usage<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
<div class="section" id="related-references">
<h5>Related references<a class="headerlink" href="#related-references" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference internal" href="contents.html#thecore-stm32f4-cs43l22"><span class="std std-ref">STM32F4 discovery audio example with CS43L22 audio DAC</span></a></li>
<li><a class="reference internal" href="#stm32-dma"><span class="std std-ref">DMA documentation</span></a></li>
<li><a class="reference internal" href="contents.html#thecore-cs43l22"><span class="std std-ref">Cirrus Logic CS43L22 audio DAC</span></a></li>
</ul>
</div>
</div>
<div class="section" id="spi">
<h4>SPI<a class="headerlink" href="#spi" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
<div class="section" id="dma-overview">
<span id="stm32-dma"></span><h4>DMA overview<a class="headerlink" href="#dma-overview" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver sources:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/family/export/stm32_dma_wrap_interface.hpp</span></code>
<code class="docutils literal"><span class="pre">platform/stm32/family/f4xx/export/stm32_dma_wrap.hpp</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Template file:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/stm32/family/f4xx/templates/dma_cfg.in.hpp</span></code></td>
</tr>
</tbody>
</table>
<p>Direct memory access (DMA) is used in order to provide high-speed data transfer between
peripherals and memory and between memory and memory. Data can be quickly moved by
DMA without any CPU action. This keeps CPU resources free for other operations.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">DMA configuration via JSON is supported only for STM32F4 family.</p>
</div>
<p>In most cases, DMA is used internally by the platform-level drivers.
Platform drivers, like I2C or I2S can be linked with particular DMA by using
its alias.</p>
<p>Each driver with DMA support will include corresponding DMA example.</p>
<p>Configuration parameters (stream, channel, etc.) heavily depends on MCU model.
Refer to the <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a> for allowed DMA configuration for selected periphery.</p>
</div>
<div class="section" id="dma-in-stm32f4-mcu-family">
<h4>DMA in STM32F4 MCU family<a class="headerlink" href="#dma-in-stm32f4-mcu-family" title="Permalink to this headline">¶</a></h4>
<div class="section" id="schema">
<h5>Schema<a class="headerlink" href="#schema" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>

  <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;num&quot;</span><span class="p">:</span>          <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="p">]</span> <span class="p">},</span>
      <span class="nt">&quot;stream&quot;</span><span class="p">:</span>       <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="nt">&quot;minimum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nt">&quot;maximum&quot;</span><span class="p">:</span> <span class="mi">7</span> <span class="p">},</span>
      <span class="nt">&quot;channel&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="nt">&quot;minimum&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nt">&quot;maximum&quot;</span><span class="p">:</span> <span class="mi">7</span> <span class="p">},</span>
      <span class="nt">&quot;alias&quot;</span><span class="p">:</span>        <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
      <span class="nt">&quot;comment&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
    <span class="p">},</span>

    <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="s2">&quot;stream&quot;</span><span class="p">,</span> <span class="s2">&quot;channel&quot;</span> <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id11">
<h5>Properties<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">num</span></code> - DMA number. There are 2 DMAs on STM32F4. There are two DMA controllers in STM32F4.
Refer to the section <em>10. DMA controller (DMA)</em> of the <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a>
to get more information.</li>
<li><code class="docutils literal"><span class="pre">stream</span></code> - DMA stream number. There are 8 streams for each DMA controller,
numbered from 0 to 7. See section <em>10.3.5 DMA streams</em> in the <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a>
for more details.</li>
<li><code class="docutils literal"><span class="pre">channel</span></code> - DMA channel number. There are up to 8 channels (requests) per
each DMA stream, numbered from 0 to 7.
See section <em>10.3.3 Channel selection</em> in the <a class="reference internal" href="#stm32-rm"><span class="std std-ref">RM</span></a> for more details.</li>
<li><code class="docutils literal"><span class="pre">alias</span></code> - user-defined typename, which can be used as a reference to an
concrete DMA driver instance in configuration JSON.
Must be valid C++ identifier. Refer to individual periphery documentation
for examples.</li>
<li><code class="docutils literal"><span class="pre">comment</span></code> - user-defined string, describes DMA purpose. Must be valid
string, suitable for C/C++ comments.</li>
</ul>
</div>
<div class="section" id="id12">
<h5>Example configuration<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;stm32&quot;</span><span class="p">,</span>
        <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;STM32F407VG&quot;</span><span class="p">,</span>
        <span class="nt">&quot;dma&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;num&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;stream&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="nt">&quot;channel&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_tx_dma&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;I2S3 TX DMA&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;num&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&quot;stream&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;channel&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;i2s3_rx_dma&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;I2S3 RX DMA&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="example-output">
<h5>Example output<a class="headerlink" href="#example-output" title="Permalink to this headline">¶</a></h5>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>


<span class="cm">/* I2S3 TX DMA */</span>
<span class="k">using</span> <span class="n">i2s3_tx_dma</span> <span class="o">=</span> <span class="n">ecl</span><span class="o">::</span><span class="n">dma_wrap</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">dma_stream</span><span class="o">::</span><span class="n">dma1_5</span><span class="p">,</span> <span class="n">ecl</span><span class="o">::</span><span class="n">dma_channel</span><span class="o">::</span><span class="n">ch0</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/* I2S3 RX DMA */</span>
<span class="k">using</span> <span class="n">i2s3_rx_dma</span> <span class="o">=</span> <span class="n">ecl</span><span class="o">::</span><span class="n">dma_wrap</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">dma_stream</span><span class="o">::</span><span class="n">dma1_0</span><span class="p">,</span> <span class="n">ecl</span><span class="o">::</span><span class="n">dma_channel</span><span class="o">::</span><span class="n">ch0</span><span class="o">&gt;</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="../_static/generated/stm32/f4xx/dma_example.hpp">Full STM32F4 DMA example header</a></p>
</div>
</div>
<div class="section" id="dma-in-stm32l1-mcu-family">
<h4>DMA in STM32L1 MCU family<a class="headerlink" href="#dma-in-stm32l1-mcu-family" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div></blockquote>
</div>
<div class="section" id="dma-usage">
<h4>DMA Usage<a class="headerlink" href="#dma-usage" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
<div class="section" id="pin-multiplexing">
<span id="stm32-multiplexing"></span><h4>Pin multiplexing<a class="headerlink" href="#pin-multiplexing" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
<div class="section" id="exti">
<h4>EXTI<a class="headerlink" href="#exti" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
<div class="section" id="miscellaneous-configuration">
<h4>Miscellaneous configuration<a class="headerlink" href="#miscellaneous-configuration" title="Permalink to this headline">¶</a></h4>
<div class="section" id="console">
<span id="stm32-console"></span><h5>Console<a class="headerlink" href="#console" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction. For now, all examples in the
<a class="reference internal" href="contents.html#thecore-examples"><span class="std std-ref">Examples</span></a> section leverage the console. Use them as
a guidance when enabling console for your application.</p>
</div>
</div>
</div>
</div>
<span id="document-platform/ti-tivac-tm4c123g"></span><div class="section" id="texas-instruments-tiva-c-tm4c123g">
<h3>Texas Instruments Tiva C TM4C123G<a class="headerlink" href="#texas-instruments-tiva-c-tm4c123g" title="Permalink to this headline">¶</a></h3>
<p>Tiva C TM4C123G is a Cortex-M4 based microcontroller from Texas Instruments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Module location:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Supported devices:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body">TM4C123GH6PM</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Data sheets/Reference manuals:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><a class="reference external" href="TM4C123GH6PMdatasheet">TM4C123GH6PM</a></td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The platform is configured by theCore configurator.
To make sure you are familiar with it, check the <a class="reference internal" href="contents.html#thecore-configurator"><span class="std std-ref">JSON-based configurator</span></a>
section before going any further.</p>
</div>
<p>Minimal configuration JSON file for the TM4C MCU must contain the platform
object with following fields:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">name</span></code> - platform name (simply <code class="docutils literal"><span class="pre">tm4c</span></code>)</li>
<li><code class="docutils literal"><span class="pre">device</span></code> - desired device ID. Depends on MCU.</li>
</ul>
</div></blockquote>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Currently, only <code class="docutils literal"><span class="pre">TM4C123GH6PM</span></code> device is supported.</p>
</div>
<p>For example, the basic configuration can look like that:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="p">{</span>
     <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
         <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;TM4C123GH6PM&quot;</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>To import all generated definitions into the application code, simply add following
line to your source:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;aux/generated.hpp&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p>For more JSON configuration examples for TM4C platform, refer to the
<a class="reference internal" href="contents.html#thecore-examples"><span class="std std-ref">Examples</span></a> page.</p>
<div class="section" id="periphery-overview">
<h4>Periphery overview<a class="headerlink" href="#periphery-overview" title="Permalink to this headline">¶</a></h4>
<p>TM4C MCU peripheries can be configured within the same JSON file.
Layout of the platform configuration object is described by JSON schema,
placed under <code class="docutils literal"><span class="pre">platform/tm4c/schemas/tm4c.schema.json</span></code>:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>

    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span>           <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^tm4c$&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;device&quot;</span><span class="p">:</span>         <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;TM4C123GH6PM&quot;</span> <span class="p">]</span> <span class="p">},</span>
        <span class="nt">&quot;console&quot;</span><span class="p">:</span>        <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^UART\\d$&quot;</span> <span class="p">},</span>

        <span class="nt">&quot;systmr_cfg&quot;</span><span class="p">:</span>     <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:systmr.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;uart&quot;</span><span class="p">:</span>           <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:uart.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;pinmux&quot;</span><span class="p">:</span>         <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:pinmux.schema.json&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;gpio_alias&quot;</span><span class="p">:</span>     <span class="p">{</span> <span class="nt">&quot;$ref&quot;</span><span class="p">:</span> <span class="s2">&quot;file:gpio_alias.schema.json&quot;</span> <span class="p">}</span>
    <span class="p">},</span>

    <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;device&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Each periphery configuration placed under a property with a relevant name.
The example below illustrates UART periphery being added to JSON config:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="p">{</span>
     <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
         <span class="nt">&quot;device&quot;</span><span class="p">:</span> <span class="s2">&quot;TM4C123GH6PM&quot;</span><span class="p">,</span>
         <span class="nt">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
             <span class="p">{</span>
                 <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0&quot;</span><span class="p">,</span>
                 <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;UART-over-USB output&quot;</span><span class="p">,</span>
                 <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;my_uart&quot;</span>
             <span class="p">}</span>
         <span class="p">]</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Note that to use any of periphery, corresponding pins must be configured too.
<strong>Do not forget to include pin multiplexing configuration for each desired periphery.</strong>
Proceed to the <a class="reference internal" href="#tm4c-multiplexing">TM4C Multiplexing</a> section for more details.</p>
</div>
<div class="section" id="system-timer">
<h4>System timer<a class="headerlink" href="#system-timer" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver sources:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c/export/aux/execution.hpp</span></code>
<code class="docutils literal"><span class="pre">platform/tm4c/export/aux/execution.hpp</span></code></td>
</tr>
</tbody>
</table>
<div class="section" id="json-schema">
<h5>JSON schema<a class="headerlink" href="#json-schema" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;source&quot;</span><span class="p">:</span>    <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;systick&quot;</span> <span class="p">]</span> <span class="p">},</span>
        <span class="nt">&quot;freq_hz&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="nt">&quot;minimum&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nt">&quot;maximum&quot;</span><span class="p">:</span> <span class="mi">1000</span> <span class="p">},</span>
        <span class="nt">&quot;owner&quot;</span><span class="p">:</span>     <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;thecore&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">]</span> <span class="p">},</span>
        <span class="nt">&quot;comment&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
    <span class="p">},</span>

    <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;owner&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="example-configuration">
<h5>Example configuration<a class="headerlink" href="#example-configuration" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="p">{</span>
     <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
         <span class="nt">&quot;systmr_cfg&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;systick&quot;</span><span class="p">,</span>
             <span class="nt">&quot;freq_hz&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
             <span class="nt">&quot;owner&quot;</span><span class="p">:</span> <span class="s2">&quot;user&quot;</span>
         <span class="p">}</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Properties:
.. note:: This section is under construction</p>
</div>
<div class="section" id="usage">
<h5>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<div class="section" id="uart">
<h4>UART<a class="headerlink" href="#uart" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver sources:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c/export/aux/uart_bus.hpp</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Template file:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c/templates/uart_cfg.in.hpp</span></code></td>
</tr>
</tbody>
</table>
<div class="section" id="id1">
<h5>JSON schema<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>

    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^UART\\d$&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;alias&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">},</span>

        <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;id&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id2">
<h5>Example configuration<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
        <span class="nt">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;test_uart&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;UART-over-USB console output&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;UART1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;another_uart&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Example UART&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="example-output">
<h5>Example output<a class="headerlink" href="#example-output" title="Permalink to this headline">¶</a></h5>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>

<span class="c1">// UART configuration ---------------------------------------------------------</span>


<span class="cm">/* UART-over-USB console output */</span>
<span class="k">static</span> <span class="k">constexpr</span> <span class="n">uart_device</span> <span class="n">template_console_dev</span> <span class="o">=</span> <span class="n">uart_device</span><span class="o">::</span><span class="n">dev0</span><span class="p">;</span>
<span class="k">using</span> <span class="n">platform_console</span> <span class="o">=</span> <span class="n">uart_bus</span><span class="o">&lt;</span><span class="n">template_console_dev</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/* Example UART */</span>
<span class="k">static</span> <span class="k">constexpr</span> <span class="n">uart_device</span> <span class="n">template_console_dev</span> <span class="o">=</span> <span class="n">uart_device</span><span class="o">::</span><span class="n">dev1</span><span class="p">;</span>
<span class="k">using</span> <span class="n">platform_console</span> <span class="o">=</span> <span class="n">uart_bus</span><span class="o">&lt;</span><span class="n">template_console_dev</span><span class="o">&gt;</span><span class="p">;</span>


<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="_static/generated/tm4c/uart_example.hpp">Full TM4C UART example header</a></p>
</div>
<div class="section" id="console">
<h5>Console<a class="headerlink" href="#console" title="Permalink to this headline">¶</a></h5>
<p>To enable console in theCore, set <code class="docutils literal"><span class="pre">console</span></code> field to desired UART instance
and enable that instance, all via JSON:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
        <span class="nt">&quot;console&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0&quot;</span><span class="p">,</span>
        <span class="nt">&quot;uart&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;UART-over-USB console output&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Check the <a class="reference internal" href="contents.html#thecore-console"><span class="std std-ref">Console streams</span></a> section for more details about theCore console
library.</p>
</div>
<div class="section" id="id3">
<h5>Usage<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<div class="section" id="pin-multiplexing">
<span id="tm4c-multiplexing"></span><h4>Pin multiplexing<a class="headerlink" href="#pin-multiplexing" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver sources:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c/export/platform/pin_cfg.hpp</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Template file:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c/templates/pin_mux.in.hpp</span></code></td>
</tr>
</tbody>
</table>
<div class="section" id="id4">
<h5>JSON schema<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>

    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;dir&quot;</span><span class="p">:</span>          <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;in&quot;</span><span class="p">,</span> <span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="s2">&quot;hw&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;pin_type&quot;</span><span class="p">:</span>     <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="s2">&quot;pull&quot;</span><span class="p">,</span> <span class="s2">&quot;od&quot;</span><span class="p">,</span> <span class="s2">&quot;analog&quot;</span><span class="p">,</span> <span class="s2">&quot;wake_high&quot;</span><span class="p">,</span> <span class="s2">&quot;wake_low&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;strength&quot;</span><span class="p">:</span>     <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;2mA&quot;</span><span class="p">,</span> <span class="s2">&quot;4mA&quot;</span><span class="p">,</span> <span class="s2">&quot;6mA&quot;</span><span class="p">,</span> <span class="s2">&quot;8mA&quot;</span><span class="p">,</span> <span class="s2">&quot;8mA_sc&quot;</span><span class="p">,</span> <span class="s2">&quot;10mA&quot;</span><span class="p">,</span> <span class="s2">&quot;12mA&quot;</span> <span class="p">]</span> <span class="p">},</span>
            <span class="nt">&quot;comment&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>

            <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
                <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^P\\w\\d{1,2}$&quot;</span> <span class="p">}</span>
            <span class="p">},</span>

            <span class="nt">&quot;hws&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
                <span class="nt">&quot;patternProperties&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;^P\\w\\d{1,2}$&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>

        <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;ids&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id5">
<h5>Example configuration<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
        <span class="nt">&quot;pinmux&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;PF1&quot;</span><span class="p">,</span> <span class="s2">&quot;PF2&quot;</span><span class="p">,</span> <span class="s2">&quot;PF3&quot;</span> <span class="p">],</span>
                <span class="nt">&quot;dir&quot;</span><span class="p">:</span> <span class="s2">&quot;out&quot;</span><span class="p">,</span>
                <span class="nt">&quot;pin_type&quot;</span><span class="p">:</span> <span class="s2">&quot;std&quot;</span><span class="p">,</span>
                <span class="nt">&quot;strength&quot;</span><span class="p">:</span> <span class="s2">&quot;2mA&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;LED pins&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;ids&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;PA0&quot;</span><span class="p">,</span> <span class="s2">&quot;PA1&quot;</span> <span class="p">],</span>
                <span class="nt">&quot;dir&quot;</span><span class="p">:</span> <span class="s2">&quot;hw&quot;</span><span class="p">,</span>
                <span class="nt">&quot;hws&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;PA0&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0_RX&quot;</span><span class="p">,</span> <span class="nt">&quot;PA1&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0_TX&quot;</span> <span class="p">},</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;UART0 console pins&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id6">
<h5>Example output<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="kt">void</span> <span class="n">gpio_init_generated</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">enable_periph</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">a</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">enable_periph</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">f</span><span class="o">&gt;</span><span class="p">();</span>

    <span class="cm">/* LED pins */</span>

    <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">apply_cfg</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">f</span><span class="p">,</span> <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin1</span><span class="o">&gt;</span><span class="p">(</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">dir</span><span class="o">::</span><span class="n">out</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">pad_type</span><span class="o">::</span><span class="n">push_pull</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">strength</span><span class="o">::</span><span class="n">i2ma</span>
        <span class="p">);</span>


    <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">apply_cfg</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">f</span><span class="p">,</span> <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin2</span><span class="o">&gt;</span><span class="p">(</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">dir</span><span class="o">::</span><span class="n">out</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">pad_type</span><span class="o">::</span><span class="n">push_pull</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">strength</span><span class="o">::</span><span class="n">i2ma</span>
        <span class="p">);</span>


    <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">apply_cfg</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">f</span><span class="p">,</span> <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin3</span><span class="o">&gt;</span><span class="p">(</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">dir</span><span class="o">::</span><span class="n">out</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">pad_type</span><span class="o">::</span><span class="n">push_pull</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">strength</span><span class="o">::</span><span class="n">i2ma</span>
        <span class="p">);</span>

    <span class="cm">/* UART0 console pins */</span>

    <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">apply_cfg</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">a</span><span class="p">,</span> <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin0</span><span class="o">&gt;</span><span class="p">(</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">dir</span><span class="o">::</span><span class="n">hw</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">pad_type</span><span class="o">::</span><span class="n">push_pull</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">strength</span><span class="o">::</span><span class="n">i2ma</span>
        <span class="p">);</span>


    <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">apply_cfg</span><span class="o">&lt;</span><span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">a</span><span class="p">,</span> <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin1</span><span class="o">&gt;</span><span class="p">(</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">dir</span><span class="o">::</span><span class="n">hw</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">pad_type</span><span class="o">::</span><span class="n">push_pull</span><span class="p">,</span>
            <span class="n">ecl</span><span class="o">::</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">strength</span><span class="o">::</span><span class="n">i2ma</span>
        <span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="_static/generated/tm4c/pin_mux_example.cpp">Full TM4C GPIO pin multiplexing source file</a></p>
</div>
<div class="section" id="id7">
<h5>Usage<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<div class="section" id="gpio-aliases">
<h4>GPIO aliases<a class="headerlink" href="#gpio-aliases" title="Permalink to this headline">¶</a></h4>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Driver sources:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c/export/platform/gpio_device.hpp</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Template file:</th><td class="field-body"><code class="docutils literal"><span class="pre">platform/tm4c/templates/gpio_cfg.in.hpp</span></code></td>
</tr>
</tbody>
</table>
<div class="section" id="id8">
<h5>JSON schema<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>

    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
    <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>

        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span>      <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^P\\w\\d{1,2}$&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;alias&quot;</span><span class="p">:</span>   <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
        <span class="p">},</span>

        <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;alias&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id9">
<h5>Example configuration<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;tm4c&quot;</span><span class="p">,</span>
        <span class="nt">&quot;gpio_alias&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PF1&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;led_red&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Red LED&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PF2&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;led_blue&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Blue LED&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;PF3&quot;</span><span class="p">,</span>
                <span class="nt">&quot;alias&quot;</span><span class="p">:</span> <span class="s2">&quot;led_green&quot;</span><span class="p">,</span>
                <span class="nt">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Green LED&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id10">
<h5>Example output<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h5>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>

<span class="c1">// GPIO drivers ----------------------------------------------------------------</span>

<span class="cm">/* Red LED */</span>
<span class="k">using</span> <span class="n">led_red</span> <span class="o">=</span> <span class="n">gpio</span><span class="o">&lt;</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">f</span><span class="p">,</span> <span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin1</span><span class="o">&gt;</span><span class="p">;</span>
<span class="cm">/* Blue LED */</span>
<span class="k">using</span> <span class="n">led_blue</span> <span class="o">=</span> <span class="n">gpio</span><span class="o">&lt;</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">f</span><span class="p">,</span> <span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin2</span><span class="o">&gt;</span><span class="p">;</span>
<span class="cm">/* Green LED */</span>
<span class="k">using</span> <span class="n">led_green</span> <span class="o">=</span> <span class="n">gpio</span><span class="o">&lt;</span><span class="n">gpio_hw</span><span class="o">::</span><span class="n">port</span><span class="o">::</span><span class="n">f</span><span class="p">,</span> <span class="n">gpio_hw</span><span class="o">::</span><span class="n">num</span><span class="o">::</span><span class="n">pin3</span><span class="o">&gt;</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="_static/generated/tm4c/gpio_alias_example.hpp">Full TM4C GPIO alias example header</a></p>
</div>
<div class="section" id="id11">
<h5>Usage<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<div class="section" id="external-interrupts">
<h4>External interrupts<a class="headerlink" href="#external-interrupts" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
</div>
<span id="document-platform/particle-electron"></span><div class="section" id="particle-electron">
<h3>Particle Electron<a class="headerlink" href="#particle-electron" title="Permalink to this headline">¶</a></h3>
<p>Particle electron is a tiny development kit for creating 3G cellular
connected products.</p>
<p>Particle electron uses its own SDK. theCore provides wrappers for I2C and Serial
peripherals.</p>
<p>Particle electron platform can be configured via JSON. Configuration file
must conform to a schema below:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;$schema&quot;</span><span class="p">:</span> <span class="s2">&quot;http://json-schema.org/schema#&quot;</span><span class="p">,</span>

  <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span>       <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span> <span class="nt">&quot;pattern&quot;</span><span class="p">:</span> <span class="s2">&quot;^particle_electron$&quot;</span> <span class="p">},</span>

    <span class="nt">&quot;systmr_cfg&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
      <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;freq_hz&quot;</span><span class="p">:</span>  <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;owner&quot;</span><span class="p">:</span>    <span class="p">{</span> <span class="nt">&quot;enum&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;thecore&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span> <span class="p">]</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nt">&quot;serial&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
      <span class="nt">&quot;items&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span> <span class="p">}</span>
    <span class="p">},</span>

    <span class="nt">&quot;i2c&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
      <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;speed&quot;</span><span class="p">:</span>        <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;integer&quot;</span> <span class="p">},</span>
        <span class="nt">&quot;stretch_clk&quot;</span><span class="p">:</span>  <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span>

    <span class="nt">&quot;use_console&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;boolean&quot;</span> <span class="p">}</span>

  <span class="p">},</span>

  <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;name&quot;</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Following sections provide configuration reference for each periphery.</p>
<div class="section" id="serial">
<h4>Serial<a class="headerlink" href="#serial" title="Permalink to this headline">¶</a></h4>
<p>Serial is used for communication between the Electron and a computer or
other devices. The Electron has four hardware (USART) serial channels and
two USB serial channels.</p>
<p>theCore allows to enable particular Serial by its number on default baud rate.
Desired serial number must put into array with <code class="docutils literal"><span class="pre">serial</span></code> name.</p>
<div class="section" id="example-configuration">
<h5>Example configuration<a class="headerlink" href="#example-configuration" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span>   <span class="s2">&quot;particle_electron&quot;</span><span class="p">,</span>
        <span class="nt">&quot;serial&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="example-output">
<h5>Example output<a class="headerlink" href="#example-output" title="Permalink to this headline">¶</a></h5>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>

<span class="c1">// Serial devices definitions</span>

<span class="k">using</span> <span class="n">serial_device0</span> <span class="o">=</span> <span class="n">uart_bus</span><span class="o">&lt;</span><span class="n">uart_device</span><span class="o">::</span><span class="n">serial0</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">serial_device2</span> <span class="o">=</span> <span class="n">uart_bus</span><span class="o">&lt;</span><span class="n">uart_device</span><span class="o">::</span><span class="n">serial2</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">using</span> <span class="n">serial_device3</span> <span class="o">=</span> <span class="n">uart_bus</span><span class="o">&lt;</span><span class="n">uart_device</span><span class="o">::</span><span class="n">serial3</span><span class="o">&gt;</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="../_static/generated/particle_electron/serial_example.hpp">Full Particle Electron Serial example header</a></p>
</div>
<div class="section" id="console">
<h5>Console<a class="headerlink" href="#console" title="Permalink to this headline">¶</a></h5>
<p>To enable console in theCore, set <code class="docutils literal"><span class="pre">use_console</span></code> flag and enable <code class="docutils literal"><span class="pre">Serial0</span></code>
via JSON:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span>         <span class="s2">&quot;particle_electron&quot;</span><span class="p">,</span>
        <span class="nt">&quot;serial&quot;</span><span class="p">:</span>       <span class="p">[</span> <span class="mi">0</span> <span class="p">],</span>
        <span class="nt">&quot;console&quot;</span><span class="p">:</span>      <span class="kc">true</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Check the <a class="reference internal" href="contents.html#thecore-console"><span class="std std-ref">Console streams</span></a> section for more details about theCore console
library.</p>
</div>
<div class="section" id="related-references">
<h5>Related references<a class="headerlink" href="#related-references" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference external" href="https://docs.particle.io/reference/firmware/electron/#serial">Official Serial documentation</a></li>
</ul>
</div>
</div>
<div class="section" id="wire-i2c">
<h4>Wire (I2C)<a class="headerlink" href="#wire-i2c" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>theCore allows to configure only one Wire/I2C instance with a pinout:</p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">SCL</span></code> =&gt; <code class="docutils literal"><span class="pre">D1</span></code></li>
<li><code class="docutils literal"><span class="pre">SDA</span></code> =&gt; <code class="docutils literal"><span class="pre">D0</span></code></li>
</ul>
</div>
<div class="section" id="id1">
<h5>Example configuration<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span>   <span class="s2">&quot;particle_electron&quot;</span><span class="p">,</span>
        <span class="nt">&quot;i2c&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;speed&quot;</span><span class="p">:</span> <span class="mi">20000</span><span class="p">,</span>
            <span class="nt">&quot;stretch_clk&quot;</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id2">
<h5>Example output<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">ecl</span>
<span class="p">{</span>

<span class="c1">// I2C device defintions</span>


<span class="k">template</span><span class="o">&lt;&gt;</span>
<span class="k">struct</span> <span class="n">i2c_bus_cfg</span><span class="o">&lt;</span><span class="n">i2c_device</span><span class="o">::</span><span class="n">wire0</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="k">auto</span> <span class="n">speed</span>         <span class="o">=</span> <span class="mi">20000</span><span class="p">;</span>
    <span class="k">static</span> <span class="k">constexpr</span> <span class="k">auto</span> <span class="n">stretch_clk</span>   <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">using</span> <span class="n">i2c_dev</span> <span class="o">=</span> <span class="n">i2c_bus</span><span class="o">&lt;</span><span class="n">i2c_device</span><span class="o">::</span><span class="n">wire0</span><span class="o">&gt;</span><span class="p">;</span>

<span class="p">}</span> <span class="c1">// namespace ecl</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference external" href="../_static/generated/particle_electron/i2c_example.hpp">Full Particle Electron I2C/Wire example header</a></p>
</div>
<div class="section" id="properties">
<h5>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">speed</span></code> - <a class="reference external" href="https://docs.particle.io/reference/firmware/electron/#setspeed-">I2C clock speed</a>. Required field.</li>
<li><code class="docutils literal"><span class="pre">stretch_clk</span></code> - <a class="reference external" href="https://docs.particle.io/reference/firmware/electron/#stretchclock-">I2C clock stretching</a>.</li>
</ul>
</div>
</div>
<div class="section" id="timer-allocation">
<h4>Timer allocation<a class="headerlink" href="#timer-allocation" title="Permalink to this headline">¶</a></h4>
<p>To save power and improve performance, theCore uses one of Particle timers internally.
Find more details of Timers in the <a class="reference external" href="https://docs.particle.io/reference/firmware/electron/#software-timers">Particle Electron documentation for software timers</a></p>
</div>
<div class="section" id="flashing-firmware">
<h4>Flashing firmware<a class="headerlink" href="#flashing-firmware" title="Permalink to this headline">¶</a></h4>
<p>To flash resulting binary to the board, follow next sequence:</p>
<ul class="simple">
<li>Put device into the <a class="reference external" href="https://docs.particle.io/guide/getting-started/modes/electron/#dfu-mode-device-firmware-upgrade-">DFU mode</a></li>
<li>Launch <code class="docutils literal"><span class="pre">scripts/electron_dfu.sh</span></code> script with a path to a binary as an argument.</li>
</ul>
</div>
</div>
<span id="document-platform/kinetis-ke02z"></span><div class="section" id="kinetis-ke02z">
<h3>Kinetis KE02Z<a class="headerlink" href="#kinetis-ke02z" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction</p>
</div>
</div>
<span id="document-platform/host"></span><div class="section" id="host">
<h3>Host<a class="headerlink" href="#host" title="Permalink to this headline">¶</a></h3>
<p>Host platform is not a full-featured platform, like <a class="reference internal" href="contents.html#thecore-stm32"><span class="std std-ref">STM32</span></a>,
but rather a place for evaluation and running unit tests.</p>
<p>Example configuration:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="p">{</span>
     <span class="nt">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host&quot;</span><span class="p">,</span>
         <span class="nt">&quot;console&quot;</span><span class="p">:</span> <span class="kc">true</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal"><span class="pre">console</span></code> property controls whether console is enabled in the platform, or not.
For more details on theCore console, check the <a class="reference internal" href="contents.html#thecore-console"><span class="std std-ref">Console streams</span></a> section.</p>
<div class="section" id="related-references">
<h4>Related references<a class="headerlink" href="#related-references" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><a class="reference internal" href="contents.html#thecore-host-hello"><span class="std std-ref">Simple host hello world example</span></a></li>
</ul>
</div>
</div>
</div>
</div>
<span id="document-drivers"></span><div class="section" id="drivers">
<h2>Drivers<a class="headerlink" href="#drivers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cirrus-logic-cs43l22-audio-dac">
<span id="thecore-cs43l22"></span><h3>Cirrus Logic CS43L22 audio DAC<a class="headerlink" href="#cirrus-logic-cs43l22-audio-dac" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="hm-10-bluetooth-btle-module">
<h3>HM-10 Bluetooth BTLE module<a class="headerlink" href="#hm-10-bluetooth-btle-module" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="pc8544-nokia-5110-display">
<h3>PC8544 Nokia 5110 display<a class="headerlink" href="#pc8544-nokia-5110-display" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="sdspi-driver">
<h3>SDSPI driver<a class="headerlink" href="#sdspi-driver" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="bh1750-digital-light-sensor">
<h3>BH1750 Digital Light sensor<a class="headerlink" href="#bh1750-digital-light-sensor" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="fc-28-moisture-sensor">
<h3>FC-28 moisture sensor<a class="headerlink" href="#fc-28-moisture-sensor" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="htu21d-humidity-and-temperature-sensor">
<h3>HTU21D humidity and temperature sensor<a class="headerlink" href="#htu21d-humidity-and-temperature-sensor" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-utilities"></span><div class="section" id="libraries-and-utilities">
<h2>Libraries and utilities<a class="headerlink" href="#libraries-and-utilities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="json-based-configurator">
<span id="thecore-configurator"></span><h3>JSON-based configurator<a class="headerlink" href="#json-based-configurator" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
<p>theCore configurator is the utility that allows to configure
the framework with respect to user-defined parameters, such as a platform name,
a clock speed or a console baud rate.</p>
<p>The configurator runs during build, thus imposing no additional cost in runtime.</p>
<p>To start using the configurator, simply create a JSON file, describing required config
and pass an absolute path of the JSON using either <code class="docutils literal"><span class="pre">THECORE_TARGET_CONFIG_FILE</span></code> CMake variable,
or using <code class="docutils literal"><span class="pre">theCore_set_target_config</span></code> CMake function in your project CMake file.</p>
<div class="section" id="simplest-example">
<h4>Simplest example<a class="headerlink" href="#simplest-example" title="Permalink to this headline">¶</a></h4>
<p>To configure theCore to be used on the host platform, one can perform
following steps:</p>
<ul>
<li><p class="first">Create JSON with the require configuration - <code class="docutils literal"><span class="pre">target_config.json</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s1">&#39;</span>
<span class="p">{</span>
    <span class="s2">&quot;platform&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="s1">&#39; &gt; target_config.json</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the main source file - <code class="docutils literal"><span class="pre">main.cpp</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s1">&#39;</span>
<span class="nb">int</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span> <span class="k">for</span><span class="p">(;;);</span> <span class="o">/*</span> <span class="n">Just</span> <span class="k">for</span> <span class="n">demonstration</span> <span class="o">*/</span> <span class="p">}</span>
<span class="s1">&#39; &gt; main.cpp</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the main project CMake file - <code class="docutils literal"><span class="pre">CMakeLists.txt</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>echo &#39;
include(${CORE_DIR}/build_api.cmake)

add_executable(main main.cpp)

theCore_set_target_config(&quot;${CMAKE_CURRENT_LIST_DIR}/target_config.json&quot;)
&#39; &gt; CMakeLists.txt
</pre></div>
</div>
</li>
<li><p class="first">Launch build and the app:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
<span class="o">./</span><span class="n">main</span>
</pre></div>
</div>
</li>
</ul>
<p>The approach described here is basic for all platforms, but values in JSON of course
are different. This of JSON as it is being API between user and theCore.</p>
<p>Such APIs exposed by different modules. Here are some references:</p>
<blockquote>
<div><ul class="simple">
<li>The <a class="reference internal" href="contents.html#thecore-platforms"><span class="std std-ref">Supported platforms</span></a> section contains platform-level configuration explanation.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="json-configuration-examples">
<h4>JSON configuration examples<a class="headerlink" href="#json-configuration-examples" title="Permalink to this headline">¶</a></h4>
<p>To get more insights about theCore configuration, refer to the <a class="reference internal" href="contents.html#thecore-examples"><span class="std std-ref">Examples</span></a>
page. Each example there contains a subsection with a JSON config displayed.</p>
</div>
<div class="section" id="json-validation">
<h4>JSON validation<a class="headerlink" href="#json-validation" title="Permalink to this headline">¶</a></h4>
<p>Each theCore module that exposes the configuration API, also provides
<a class="reference external" href="http://json-schema.org/">JSON schema</a> for basic input validation. Usually if the JSON does not match
required schema the build error looks like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">jsonschema</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ValidationError</span><span class="p">:</span> <span class="s1">&#39;zzzz&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">of</span> <span class="nb">type</span> <span class="s1">&#39;integer&#39;</span>

<span class="n">Failed</span> <span class="n">validating</span> <span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;uart&#39;</span><span class="p">][</span><span class="s1">&#39;items&#39;</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;baud&#39;</span><span class="p">]:</span>
    <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">}</span>

<span class="n">On</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;uart&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;baud&#39;</span><span class="p">]:</span>
    <span class="s1">&#39;zzzz&#39;</span>
</pre></div>
</div>
<p>In the example above, baud rate of UART was not specified correctly. This kind
of errors the schema can easily catch. Refer to the concrete module
documentation or the source code to understand which values are validated.</p>
</div>
</div>
<div class="section" id="console-streams">
<span id="thecore-console"></span><h3>Console streams<a class="headerlink" href="#console-streams" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="bypass-console">
<h3>Bypass console<a class="headerlink" href="#bypass-console" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="assertions-and-error-handling">
<h3>Assertions and error handling<a class="headerlink" href="#assertions-and-error-handling" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="filesystem">
<h3>Filesystem<a class="headerlink" href="#filesystem" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="newlib-stubs">
<h3>Newlib stubs<a class="headerlink" href="#newlib-stubs" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-os_layer"></span><div class="section" id="os-abstraction-layer">
<span id="thecore-os"></span><h2>OS abstraction layer<a class="headerlink" href="#os-abstraction-layer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="no-os-abstractions">
<h3>No-OS abstractions<a class="headerlink" href="#no-os-abstractions" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="freertos">
<h3>FreeRTOS<a class="headerlink" href="#freertos" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="posix-host">
<h3>POSIX (host)<a class="headerlink" href="#posix-host" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-community"></span><div class="section" id="community-and-developer-guidelines">
<span id="thecore-developerdocs"></span><h2>Community and developer guidelines<a class="headerlink" href="#community-and-developer-guidelines" title="Permalink to this headline">¶</a></h2>
<p>To make referencing easier, rules and guidelines (if present) are numbered inside section.</p>
<div class="section" id="roadmap">
<span id="thecore-roadmap"></span><h3>Roadmap<a class="headerlink" href="#roadmap" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="branching-and-release-model">
<span id="thecore-branching"></span><h3>Branching and release model<a class="headerlink" href="#branching-and-release-model" title="Permalink to this headline">¶</a></h3>
<p>There are two main branches - <code class="docutils literal"><span class="pre">develop</span></code> and <code class="docutils literal"><span class="pre">master</span></code>.
Both branches are protected against force-pushing unless it is really-really
required (almost never happen).</p>
<p>As names state, all the development (normally) happens in <code class="docutils literal"><span class="pre">develop</span></code> branch,
while <code class="docutils literal"><span class="pre">master</span></code> contains stable versions. <code class="docutils literal"><span class="pre">master</span></code> branch is tagged according
to <a class="reference external" href="http://semver.org/">the semantic versioning approach</a>.</p>
<p>Full explanation of branching model, accepted in theCore you can find in <a class="reference external" href="http://nvie.com/posts/a-successful-git-branching-model/">nvie git article</a>.</p>
</div>
<div class="section" id="code-style">
<h3>Code style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The source formatting script called <code class="docutils literal"><span class="pre">srcformat.sh</span></code> in <code class="docutils literal"><span class="pre">scripts</span></code> directory,
though it is still under development.</p>
</div>
<div class="section" id="whitespaces-and-indentation">
<h4>Whitespaces and indentation<a class="headerlink" href="#whitespaces-and-indentation" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Do not use tabs. Only spaces are allowed.</p>
</li>
<li><p class="first">Set indent to 4 spaces per indent.</p>
</li>
<li><p class="first">Indent <code class="docutils literal"><span class="pre">public</span></code>, <code class="docutils literal"><span class="pre">private</span></code>, <code class="docutils literal"><span class="pre">protected</span></code> with the same indent as
a <code class="docutils literal"><span class="pre">class</span></code> block.</p>
</li>
<li><p class="first">Indent <code class="docutils literal"><span class="pre">class</span></code> block with the same indent as a namespace:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// OK</span>
<span class="k">namespace</span> <span class="n">foo</span>
<span class="p">{</span>

<span class="k">class</span> <span class="nc">entity</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="cm">/* */</span>
<span class="k">private</span><span class="o">:</span>
    <span class="cm">/* */</span>
<span class="k">protected</span><span class="o">:</span>
    <span class="cm">/* */</span>
<span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace foo</span>
</pre></div>
</div>
</li>
<li><p class="first">Indent switch blocks so that the <code class="docutils literal"><span class="pre">case</span> <span class="pre">X:</span></code> statements are indented in the switch block:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// OK</span>
<span class="k">switch</span> <span class="p">(</span><span class="n">foo</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Do not indent labels.</p>
</li>
<li><p class="first">Do not indent preprocessor block.</p>
</li>
<li><p class="first">Insert spaces around operators, except <code class="docutils literal"><span class="pre">++</span></code>, <code class="docutils literal"><span class="pre">--</span></code>, <code class="docutils literal"><span class="pre">!</span></code>, <code class="docutils literal"><span class="pre">.</span></code>, <code class="docutils literal"><span class="pre">-&gt;</span></code>, <code class="docutils literal"><span class="pre">*</span></code> and <code class="docutils literal"><span class="pre">&amp;</span></code>.</p>
</li>
<li><p class="first">Insert space padding between <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">for</span></code>, <code class="docutils literal"><span class="pre">while</span></code> and the following bracket.</p>
</li>
<li><p class="first"><strong>Do not leave trailing whitespaces.</strong></p>
</li>
</ol>
</div>
<div class="section" id="bracket-placement">
<h4>Bracket placement<a class="headerlink" href="#bracket-placement" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Use <a class="reference external" href="https://en.wikipedia.org/wiki/Indent_style#Variant:_1TBS_.28OTBS.29">One True Bracket Style</a>.</p>
</li>
<li><p class="first">Place brackets in namespaces, classes, extern-“C” and functions on the next line, e.g:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// Wrong</span>
<span class="k">namespace</span> <span class="n">foo</span> <span class="p">{</span>

<span class="p">}</span>

<span class="c1">// OK</span>
<span class="k">namespace</span> <span class="n">bar</span>
<span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Add brackets to unbracketed one line conditional statements (e.g. <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">for</span></code>, <code class="docutils literal"><span class="pre">while</span></code>…).</p>
</li>
<li><p class="first">Do not put whitespace between angle brackets in template definitions:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// Good</span>
<span class="n">foo</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">bar</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">obj</span><span class="p">;</span>

<span class="c1">// Bad</span>
<span class="n">foo</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">bar</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">obj</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="code-length">
<h4>Code length<a class="headerlink" href="#code-length" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Prefer 80 character code line length. 100 characters is a maximum allowed line length.</li>
<li>Prefer to keep functions and methods with not more than 100 lines of code.</li>
</ol>
</div>
<div class="section" id="naming">
<h4>Naming<a class="headerlink" href="#naming" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Use <a class="reference external" href="https://en.wikipedia.org/wiki/Snake_case">snake_case</a> for identifiers.</p>
</li>
<li><p class="first">Use <code class="docutils literal"><span class="pre">m_</span></code> prefix when naming private and protected class members.</p>
</li>
<li><p class="first">Use CamelCase style for template parameters only:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">CrazyAllocator</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">my_strange_container</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="comments">
<h4>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first"><strong>Do not leave commented out code.</strong></p>
</li>
<li><p class="first">Prefer not keeping <code class="docutils literal"><span class="pre">TODO</span></code> in code without corresponding issue.
Place issue number next to the <code class="docutils literal"><span class="pre">TODO</span></code> with a short explanation why it is there:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// TODO #123: replace foo() with something that exposes smaller IRQ latency.</span>
<span class="n">foo</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p class="first">Use doxygen for commenting the function prototypes and class methods.</p>
</li>
<li><p class="first">Use C++ comment lines for doxygen commenting:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">//! This function does something.</span>
<span class="c1">//! \details Also it calls 911.</span>
<span class="kt">void</span> <span class="nf">foo</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p class="first">Do not use <code class="docutils literal"><span class="pre">\brief</span></code> doxygen directive. Brief tag is set automatically for first sentence (until the first dot).
See also <a class="reference external" href="https://www.stack.nl/~dimitri/doxygen/manual/config.html#cfg_javadoc_autobrief">autobrief docs</a>.</p>
</li>
<li><p class="first">Do not add redundant Doxygen comments, like:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">//! Set the size.</span>
<span class="c1">//! \param size The size.</span>
<span class="kt">void</span> <span class="nf">set_size</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="commit-and-pr-style">
<h3>Commit and PR style<a class="headerlink" href="#commit-and-pr-style" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Try to follow common <a class="reference external" href="https://chris.beams.io/posts/git-commit/">git guidelines</a>.</p>
</li>
<li><p class="first"><strong>Do not keep commits named just</strong> <code class="docutils literal"><span class="pre">FIX</span></code> <strong>,</strong> <code class="docutils literal"><span class="pre">Review</span></code> <strong>,</strong> <code class="docutils literal"><span class="pre">tmp</span></code> <strong>, etc.</strong></p>
</li>
<li><p class="first">Prefer placing issue number at the start of the summary line, prefixed with <code class="docutils literal"><span class="pre">&gt;#</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;#911 Implement calling police officer
</pre></div>
</div>
<p>This will be recognized by GitHub as issue reference.
Note that simply putting <code class="docutils literal"><span class="pre">#</span></code> at the beginning will not do the trick.
Since a line with the <code class="docutils literal"><span class="pre">#</span></code> at the start is interpreted as the commentary.</p>
</li>
<li><p class="first"><strong>Do not</strong> include issue number in the pull request name.</p>
</li>
<li><p class="first">Use <code class="docutils literal"><span class="pre">[WIP]</span></code> (Work In Progress) prefix for PRs that are still in progress or review
and should not be merged right away.</p>
</li>
</ol>
</div>
</div>
<span id="document-docs"></span><div class="section" id="documentation-development-and-contribution">
<h2>Documentation development and contribution<a class="headerlink" href="#documentation-development-and-contribution" title="Permalink to this headline">¶</a></h2>
<p>theCore documentation, as you may have noticed, is hosted on GitHub pages and
built using <a class="reference external" href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> with few extensions:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://docs.readthedocs.io/en/latest/theme.html">Read The Docs theme</a> - awesome theme.</li>
<li><a class="reference external" href="https://sphinxcontrib-fulltoc.readthedocs.io">FullToc</a> - full ToC in the sidebar.</li>
</ul>
</div></blockquote>
<p>All the documentation sources placed under <code class="docutils literal"><span class="pre">doc</span></code> top-level directory.</p>
<p>To contribute to the documentation, you probably would like to first build
and validate docs locally. For that, build dependencies must be installed either
manually or by using Nix. Check the <a class="reference internal" href="contents.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> for more info about
Nix option.</p>
<p>Following sections will provide you with insights about docs structure and build
procedure.</p>
<div class="section" id="building-sphinx-documentation">
<span id="thecore-building-sphinx"></span><h3>Building Sphinx documentation<a class="headerlink" href="#building-sphinx-documentation" title="Permalink to this headline">¶</a></h3>
<p>theCore build system provides a separate target for building documentation, so
there is no need to invoke Sphinx manually. Instead, proceed as follows:</p>
<ol class="arabic">
<li><p class="first">Finish <a class="reference internal" href="contents.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> to get Sphinx and additional extensions.</p>
</li>
<li><p class="first">Launch documentation build:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span># From theCore directory
mkdir doc_build
cd doc_build
cmake ../doc
make core_sphinx
</pre></div>
</div>
</li>
<li><p class="first">Open generated docs by any preferable browser:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">doc_build/sphinx/theCore/index.html</span></code> - main page of multi-page version.</li>
<li><code class="docutils literal"><span class="pre">doc_build/sphinx/theCore/singlehtml/index.html</span></code> - main page of single-paged version.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="building-doxygen-documentation">
<h3>Building Doxygen documentation<a class="headerlink" href="#building-doxygen-documentation" title="Permalink to this headline">¶</a></h3>
<p>theCore also contains Doxygen and it is possible to generate Doxygen pages
locally using CMake target:</p>
<ol class="arabic">
<li><p class="first">Launch command in the <code class="docutils literal"><span class="pre">doc_build</span></code> directory
<a class="reference internal" href="#thecore-building-sphinx"><span class="std std-ref">created on previous step</span></a>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>make core_doxygen
</pre></div>
</div>
</li>
<li><p class="first">Open index page of generated Doxygen by any preferable browser:
<code class="docutils literal"><span class="pre">doc_build/doc/doxygen/html/index.html</span></code></p>
</li>
</ol>
</div>
<div class="section" id="what-all-these-sections-are-about">
<h3>What all these sections are about?<a class="headerlink" href="#what-all-these-sections-are-about" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="publishing-docs-on-github-pages">
<h3>Publishing docs on github pages<a class="headerlink" href="#publishing-docs-on-github-pages" title="Permalink to this headline">¶</a></h3>
<p>As noted previously, docs are hosted in GitHub pages. <a class="reference external" href="https://github.com/forGGe/forGGe.github.io">The separate repository</a>
holds auto-generated static HTML files which are automatically displayed if placed in
master branch of that repo. Jekyll is disabled.</p>
<p>See also <a class="reference external" href="https://help.github.com/articles/user-organization-and-project-pages/">the GitHub pages docs</a> for more information.</p>
<p>Contributing to the documentation consist of creating a PR against <a class="reference external" href="https://github.com/forGGe/theCore">theCore repository</a>.</p>
<p>After the PR is opened, the new documentation is processed by the author manually in following fashion:</p>
<ol class="arabic">
<li><p class="first">New docs are build and tested locally, as described in <a class="reference internal" href="#building-sphinx-documentation">Building Sphinx documentation</a> section.</p>
</li>
<li><p class="first">Generated static files are copied to the github pages clone:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>cp doc_build/doc/sphinx/* /path/to/the/gh_pages/ -rv
</pre></div>
</div>
</li>
<li><p class="first">Changes are committed and pushed to the remote:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>git add -u
git commit
git push origin master
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<span id="document-testing"></span><div class="section" id="testing-and-ci">
<h2>Testing and CI<a class="headerlink" href="#testing-and-ci" title="Permalink to this headline">¶</a></h2>
<div class="section" id="unit-tests">
<h3>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="on-device-tests">
<h3>On-device tests<a class="headerlink" href="#on-device-tests" title="Permalink to this headline">¶</a></h3>
<p>theCore testing facilities provides way to create on-device and system tests
in modular and reusable manner.
theCore uses <a class="reference external" href="http://www.throwtheswitch.org/unity/">the Unity test framework</a> to create test cases.</p>
<p>On-device tests are located in the <code class="docutils literal"><span class="pre">tests</span></code> top-level directory.</p>
<div class="section" id="basic-entities">
<h4>Basic entities<a class="headerlink" href="#basic-entities" title="Permalink to this headline">¶</a></h4>
<p>A test case is a code that performs validation of the particular theCore
component or module.</p>
<p>Each test, or test case, resides in separate directory under <code class="docutils literal"><span class="pre">tests/cases</span></code> dir.
To be recognizable by theCore testing facilities the test case
must contain a definition file with <code class="docutils literal"><span class="pre">case_defs.cmake</span></code> name.</p>
<p>Test case definition file must (at least) define <code class="docutils literal"><span class="pre">CASE_SOURCES</span></code> CMake variable.
<code class="docutils literal"><span class="pre">CASE_SOURCES</span></code> must contain list of test case source files.</p>
<p>See [the unity_demo test case](cases/unity_demo) as an example.</p>
<p>You may check <code class="docutils literal"><span class="pre">tests/cases/unity_demo</span></code> as an example.</p>
</div>
<div class="section" id="targets-and-mcus">
<h4>Targets and MCUs<a class="headerlink" href="#targets-and-mcus" title="Permalink to this headline">¶</a></h4>
<p>A target is a board where tests should be executed.</p>
<p>Multiple boards can be built around single MCU type.
MCU types are placed in the <code class="docutils literal"><span class="pre">tests/mcus</span></code> directory.
Each MCU must contain <code class="docutils literal"><span class="pre">mcu_defs.cmake</span></code> and <code class="docutils literal"><span class="pre">mcu_defs.hpp</span></code> files.
Those definition files can contain arbitrary data specific to the concrete microcontroller.</p>
<p>The TM4C MCU definition file (<code class="docutils literal"><span class="pre">tests/mcus/tm4c123gh6pm/mcu_defs.cmake</span></code>)
provided here as an example:</p>
<div class="highlight-cmake"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c"># This Source Code Form is subject to the terms of the Mozilla Public</span>
<span class="c"># License, v. 2.0. If a copy of the MPL was not distributed with this</span>
<span class="c"># file, You can obtain one at http://mozilla.org/MPL/2.0/.</span>

<span class="nb">set</span><span class="p">(</span><span class="s">CONFIG_PLATFORM</span> <span class="s">tm4c</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CONFIG_PLATFORM_DEVICE</span> <span class="s">TM4C123GH6PM</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>As shown, CMake file sets the platform associated with that MCU (<code class="docutils literal"><span class="pre">CONFIG_PLATFORM</span></code>)
and the MCU model (<code class="docutils literal"><span class="pre">CONFIG_PLATFORM_DEVICE</span></code>).</p>
<p>Targets are residing in <code class="docutils literal"><span class="pre">tests/targets</span></code> directory and can reuse
MCU definitions in its own definition files: <code class="docutils literal"><span class="pre">target_defs.cmake</span></code>
and <code class="docutils literal"><span class="pre">target_defs.hpp</span></code>.</p>
<p>Targets must also declare set of test suites that they can handle
(more on this in the <a class="reference internal" href="#suites">Suites</a> section).</p>
<p>Good example of the test target is a  STM32 discovery target.
It can be found in <code class="docutils literal"><span class="pre">targets/stm32f4discovery_simple</span></code> directory.</p>
</div>
<div class="section" id="suites">
<h4>Suites<a class="headerlink" href="#suites" title="Permalink to this headline">¶</a></h4>
<p>Every target can run <cite>limited</cite> set of possible tests.
Limitations might be caused by lack of ROM, RAM or absence of the required hardware.
Sets of tests that can be executed on the target called <strong>suite</strong>.</p>
<p>Suites are specific to the target, thus placed under <code class="docutils literal"><span class="pre">&lt;target_name&gt;/suites</span></code> directory.
Suites are compiled into executables, thus every suite must contain ordinary
<code class="docutils literal"><span class="pre">CMakeLists.txt</span></code> usable with theCore.</p>
<p>Suite does not need to contain any source files except the init code
(usually placed in <code class="docutils literal"><span class="pre">suite_init.cpp</span></code>) that runs when board starts.
Suite launchers are autogenerated by <code class="docutils literal"><span class="pre">scripts/gen_suite.py</span></code> script.</p>
<p>See Unity demo suite on stm32f4 discovery target placed under
<code class="docutils literal"><span class="pre">targets/stm32f4discovery_simple/suites/unity_demo</span></code> as an example.</p>
</div>
<div class="section" id="building-thecore-suites">
<h4>Building theCore suites<a class="headerlink" href="#building-thecore-suites" title="Permalink to this headline">¶</a></h4>
<p>Existing test suites can be compiled by the following procedure
(do not forget to complete <a class="reference internal" href="contents.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> guide to obtain Nix environment):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>mkdir tests_build
cd tests_build
cmake ../tests
make
</pre></div>
</div>
<p>Paths to suite binaries are recorded in <cite>suite_list.txt</cite> file in the build directory:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ cat suite_list.txt
platform_bat,tivac_tm4,/tmp/theCore/tests/build/tivac_tm4/platform_bat.gnu//build/platform_bat,/tmp/build3/tivac_tm4/platform_bat.gnu//build/platform_bat.bin
platform_bat,stm32f4discovery_simple,/tmp/theCore/tests/build/stm32f4discovery_simple/platform_bat.gnu//build/platform_bat,/tmp/build3/stm32f4discovery_simple/platform_bat.gnu//build/platform_bat.bin
platform_bat,stm32f4discovery_simple,/tmp/theCore/tests/build/stm32f4discovery_simple/platform_bat.clang//build/platform_bat,/tmp/build3/stm32f4discovery_simple/platform_bat.clang//build/platform_bat.bin
unity_demo,stm32f4discovery_simple,/tmp/theCore/tests/build/stm32f4discovery_simple/unity_demo.gnu//build/unity_demo,/tmp/build3/stm32f4discovery_simple/unity_demo.gnu//build/unity_demo.bin
unity_demo,tivac_tm4,/tmp/theCore/tests/build/tivac_tm4/unity_demo.gnu//build/unity_demo,/tmp/build3/tivac_tm4/unity_demo.gnu//build/unity_demo.bin
</pre></div>
</div>
</div>
<div class="section" id="launching-suites">
<h4>Launching suites<a class="headerlink" href="#launching-suites" title="Permalink to this headline">¶</a></h4>
<p>Suite binaries obtained in the <a class="reference internal" href="#building-thecore-suites">Building theCore suites</a> can be flashed
into the MCU using either manual approach (using appropriate programmer)
or using <code class="docutils literal"><span class="pre">scripts/flasher.py</span></code> script.</p>
<p>The flasher script tries to flash suite binaries to connected boards
using <code class="docutils literal"><span class="pre">suite_list.txt</span></code> and the description of connected devices
in a form of JSON.</p>
<p>Such JSON must be filled manually with respect to board connected.
Example of the description file (<code class="docutils literal"><span class="pre">/scripts/connected_devices_example.json</span></code>)
demonstrated below:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;stm32f4discovery_simple&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;debugger&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;openocd&quot;</span><span class="p">,</span>
      <span class="nt">&quot;flash_params&quot;</span><span class="p">:</span> <span class="s2">&quot;init; reset halt; wait_halt; flash write_image erase {elf_path}; reset run; shutdown&quot;</span><span class="p">,</span>
      <span class="nt">&quot;conf_file&quot;</span> <span class="p">:</span> <span class="s2">&quot;stm32f4discovery.cfg&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nt">&quot;tivac_tm4&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;debugger&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;openocd&quot;</span><span class="p">,</span>
      <span class="nt">&quot;flash_params&quot;</span><span class="p">:</span> <span class="s2">&quot;init; reset halt; wait_halt; flash write_image erase {elf_path}; reset run; shutdown&quot;</span><span class="p">,</span>
      <span class="nt">&quot;conf_file&quot;</span> <span class="p">:</span> <span class="s2">&quot;ek-lm4f120xl.cfg&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="relation-to-the-examples">
<h4>Relation to the examples<a class="headerlink" href="#relation-to-the-examples" title="Permalink to this headline">¶</a></h4>
<p>Examples described in <a class="reference internal" href="contents.html#thecore-examples"><span class="std std-ref">Examples</span></a> section and on-device tests
sometimes contains overlapping functionality but have different purpose.</p>
<p>Test cases and suites are not so well documented and indicative to be threatened
as good examples.</p>
</div>
</div>
<div class="section" id="travis">
<h3>Travis<a class="headerlink" href="#travis" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-credits"></span><div class="section" id="credits-and-acknowledgements">
<span id="thecore-credits"></span><h2>Credits and acknowledgements<a class="headerlink" href="#credits-and-acknowledgements" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
<div class="section" id="invoking-sphinx-from-cmake">
<h3>Invoking Sphinx from CMake<a class="headerlink" href="#invoking-sphinx-from-cmake" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://eb2.co/blog/2012/03/sphinx-and-cmake-beautiful-documentation-for-c-projects/">Sphinx and CMake: Beautiful Documentation For C++ Projects</a> by Eric Scott Barr
is a great article, describes how to integrate those tools together.
This is how theCore builds and deploys its documentation.</p>
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>



           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Max Olender, 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>