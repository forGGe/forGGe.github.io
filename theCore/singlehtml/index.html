

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>theCore documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="None" href="index.html#document-index"/>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106363109-1', 'auto');
  ga('send', 'pageview');

</script>


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html#document-index" class="icon icon-home"> theCore
          

          
          </a>

          
            
            
          

          

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-readme">theCore: C++ Embedded Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-guides">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-examples">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-project_structure">Project structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-arch">Supported architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-platforms">Supported platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-drivers">Drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-utilities">Libraries and utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-os_layer">OS abstraction layer</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-community">Community and developer guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-docs">Documentation development and contribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-testing">Testing and CI</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-credits">Credits and acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html#document-index">theCore</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html#document-index">Docs</a> &raquo;</li>
      
    <li>theCore  documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-thecore-documentation">
<h1>Welcome to theCore documentation!<a class="headerlink" href="#welcome-to-thecore-documentation" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This documentation is under construction.
You may find that many sections are incomplete.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a single-page version of theCore documentation.
For multi-page version, click <a class="reference external" href="http://forgge.github.io/theCore/index.html">here</a>.</p>
</div>
<div class="toctree-wrapper compound">
<span id="document-readme"></span><div class="section" id="thecore-c-embedded-framework">
<h2>theCore: C++ Embedded Framework<a class="headerlink" href="#thecore-c-embedded-framework" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://travis-ci.org/forGGe/theCore"><img alt="Build Status" src="https://travis-ci.org/forGGe/theCore.svg?branch=master" /></a> <a class="reference external" href="https://gitter.im/forGGe/theCore?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img alt="Join the chat at https://gitter.im/forGGe/theCore" src="https://badges.gitter.im/forGGe/theCore.svg" /></a></p>
<div class="section" id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h3>
<p>theCore is the open source, highly configurable and straightforward C++ framework aimed
to reduce development, testing and hardware migration efforts for a wide range of
bare-metal embedded applications.</p>
<p>theCore tries to provide all that is necessary to create portable application code:</p>
<ul class="simple">
<li>Startup, initialization and periphery code for each supported platform.</li>
<li>Build system support for different platform and target configurations.</li>
<li>Platform-independent device drivers, like temperature sensors or displays.</li>
<li>Optional OS-related abstractions: semaphores, mutexes and threads.</li>
<li>Easy-to-deploy development environment.</li>
<li>Different libraries and utilities.</li>
</ul>
<p>theCore uses powerful type system based on modern C++ and code generation that
greatly reduces error rate and debugging time. Shifting different sanity checks
to compile time rather than runtime not only makes code more performant, but
also secure and easier to extend.</p>
<p>The project is at the initial stage. You can check <a class="reference internal" href="index.html#thecore-roadmap"><span class="std std-ref">Roadmap</span></a> section
in the documentation or <a class="reference external" href="https://github.com/forGGe/theCore/issues">github issues</a> to get insights on what happens
right now and where project is moving.</p>
</div>
<div class="section" id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<p>theCore documentation hosted on GitHub pages and available in two formats:
<a class="reference external" href="https://forgge.github.io/theCore/">multi-page HTML</a> for ease of navigation and <a class="reference external" href="https://forgge.github.io/theCore/singlehtml/">single-page HTML</a> for ease
of manual searching.</p>
</div>
<div class="section" id="where-to-get-thecore">
<h3>Where to get theCore<a class="headerlink" href="#where-to-get-thecore" title="Permalink to this headline">¶</a></h3>
<p>theCore is now available only from source and hosted solely on <a class="reference external" href="https://github.com/forGGe/theCore/">GitHub</a>.
There are different branches for development and stable versions. Check <a class="reference internal" href="index.html#thecore-branching"><span class="std std-ref">Branching and release model</span></a>
section for information about branches purpose.</p>
</div>
<div class="section" id="getting-started">
<h3>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<p>You can start using theCore by completing guides and tutorials in the <a class="reference internal" href="index.html#thecore-guides"><span class="std std-ref">Guides</span></a>
section or check the source code of <a class="reference external" href="https://github.com/forGGe/theCore-blinky">the standalone blinky example project</a>.</p>
<p>It is also worth to look at examples that are placed in <cite>examples</cite> dir and
read the <a class="reference internal" href="index.html#thecore-examples"><span class="std std-ref">Examples</span></a> section to understand how to build and launch them.</p>
</div>
<div class="section" id="supported-platforms">
<h3>Supported platforms<a class="headerlink" href="#supported-platforms" title="Permalink to this headline">¶</a></h3>
<p>Supported platform list along with information about each platform is located
in <a class="reference internal" href="index.html#thecore-platforms"><span class="std std-ref">Supported platforms</span></a> section.</p>
</div>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>The source code is distributed under LGPL v3.0 License.</p>
</div>
<div class="section" id="technologies-and-projects-used">
<h3>Technologies and projects used<a class="headerlink" href="#technologies-and-projects-used" title="Permalink to this headline">¶</a></h3>
<p>Most notable are:</p>
<ul class="simple">
<li>C++11 and C++14 - as a main programming language standards.</li>
<li>Python 3 and <a class="reference external" href="https://nedbatchelder.com/code/cog/">cog</a> - code generation.</li>
<li><a class="reference external" href="http://www.stack.nl/~dimitri/doxygen/">Doxygen</a> and <a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a> - in-source and project-wide documentation.</li>
<li><a class="reference external" href="https://cmake.org/">CMake</a> - build-system.</li>
<li><a class="reference external" href="https://nixos.org/nix/">Nix</a> - development environment management.</li>
<li><a class="reference external" href="http://cpputest.github.io/">CppUTest</a> and <a class="reference external" href="http://www.throwtheswitch.org/unity/">Unity</a> - unit and on-device testing.</li>
<li><a class="reference external" href="https://travis-ci.org/forGGe/theCore/">Travis</a> - continuos integration.</li>
</ul>
<p>Check the <a class="reference internal" href="index.html#thecore-credits"><span class="std std-ref">Credits and acknowledgements</span></a> section for more.</p>
</div>
<div class="section" id="contribution-using">
<h3>Contribution &amp; Using<a class="headerlink" href="#contribution-using" title="Permalink to this headline">¶</a></h3>
<p>The project is on its very beginning, so any help is more than welcome
and highly appreciated. If you’d like to take a part in the project
growth and (or) have any questions – take a look at <a class="reference internal" href="index.html#thecore-developerdocs"><span class="std std-ref">Community and developer guidelines</span></a> section,
leave message at <a class="reference external" href="https://gitter.im/forGGe/theCore">gitter</a>, contact me directly at <a class="reference external" href="mailto:forgge&#37;&#52;&#48;gmail&#46;com">forgge<span>&#64;</span>gmail<span>&#46;</span>com</a>,
or simply check out <a class="reference external" href="https://github.com/forGGe/theCore/issues">a list of theCore issues</a>.</p>
<p>If you have any suggestions on theCore improvement or just
like it how it is, don’t keep silence! I’ll be happy to read your
reviews.</p>
<p>You are welcome to use theCore in your own projects. If there is
something that it’s not enough for this, please let me know via email or
open some issues and we will do our best to handle this ASAP. Good luck!</p>
</div>
</div>
<span id="document-guides"></span><div class="section" id="guides">
<span id="thecore-guides"></span><h2>Guides<a class="headerlink" href="#guides" title="Permalink to this headline">¶</a></h2>
<div class="section" id="getting-started">
<span id="thecore-gettingstarted"></span><h3>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h3>
<div class="section" id="downloading-thecore">
<h4>Downloading theCore<a class="headerlink" href="#downloading-thecore" title="Permalink to this headline">¶</a></h4>
<p>First thing first you need to clone and update all modules of theCore.</p>
<ol class="arabic">
<li><p class="first">Clone repository:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">forGGe</span><span class="o">/</span><span class="n">theCore</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p class="first">Update all submodules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">submodule</span> <span class="n">update</span> <span class="o">--</span><span class="n">init</span> <span class="o">--</span><span class="n">recursive</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="deploying-development-environment">
<h4>Deploying development environment<a class="headerlink" href="#deploying-development-environment" title="Permalink to this headline">¶</a></h4>
<p>Now it is time to get the development environment - toolchains,
build dependencies and some additional host utilities. Everything that
you need during development of the embedded application.</p>
<p>You can either do it manually and spend decent time on that or ask
package manager called <a class="reference external" href="https://nixos.org/nix/">Nix</a> to setup all the development packages for you.</p>
<p>If you prefer to manually install dependencies, refer to <a class="reference internal" href="#thecore-nonixinstall"><span class="std std-ref">Getting required development packages without Nix</span></a>
section for more details.</p>
<p>Otherwise start with following.</p>
<ol class="arabic">
<li><p class="first">Install Nix.
On Linux and Mac OS X, the easiest way to install Nix is to run
the following shell command (as a user other than root):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nixos</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">nix</span><span class="o">/</span><span class="n">install</span> <span class="o">|</span> <span class="n">sh</span>
</pre></div>
</div>
</li>
<li><p class="first">Run Nix shell to get all environment required:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Run from theCore directory</span>
<span class="n">nix</span><span class="o">-</span><span class="n">shell</span> <span class="o">--</span><span class="n">pure</span>
</pre></div>
</div>
</li>
</ol>
<p>From now on, you are ready for creating embedded applications using theCore.</p>
</div>
<div class="section" id="more-info-about-nix">
<h4>More info about Nix<a class="headerlink" href="#more-info-about-nix" title="Permalink to this headline">¶</a></h4>
<p>If you want to get yourself more familiar with Nix, check out <a class="reference external" href="https://www.domenkozar.com/2014/01/02/getting-started-with-nix-package-manager/">the Domenkozar’s blog</a>
or read the <a class="reference external" href="https://nixos.org/nix/manual/">official documentation</a>.</p>
</div>
</div>
<div class="section" id="creating-your-first-hello-world-application">
<h3>Creating your first Hello World application<a class="headerlink" href="#creating-your-first-hello-world-application" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="multi-platform-application">
<h3>Multi-platform application<a class="headerlink" href="#multi-platform-application" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="getting-required-development-packages-without-nix">
<span id="thecore-nonixinstall"></span><h3>Getting required development packages without Nix<a class="headerlink" href="#getting-required-development-packages-without-nix" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-examples"></span><div class="section" id="examples">
<span id="thecore-examples"></span><h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>theCore examples are organized in a form of separate projects that can be
extracted and used as a base for custom application.</p>
<p>Examples are of two types. First is standalone example, placed in
the separate repository for convenience. For such, in each section you will
find a reference to the project location. Second type of examples are in-source
examples, placed under <code class="docutils literal"><span class="pre">examples</span></code> directory within theCore source tree.</p>
<div class="section" id="initial-setup">
<h3>Initial setup<a class="headerlink" href="#initial-setup" title="Permalink to this headline">¶</a></h3>
<p>Before any example can be built, an appropriate development environment must
be configured either manually by installing packages like toolchains or
by using Nix.</p>
<p>Using Nix is recommended. The <a class="reference internal" href="index.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> section contains
the explanation about how to install and run Nix.</p>
<p>To manually install required software without Nix (not recommended),
refer to <a class="reference internal" href="index.html#thecore-nonixinstall"><span class="std std-ref">Getting required development packages without Nix</span></a> section.
There you will find some insights about getting hand-made development environment.</p>
</div>
<div class="section" id="stm32f4-discovery-blinky-project">
<h3>STM32F4 discovery blinky project<a class="headerlink" href="#stm32f4-discovery-blinky-project" title="Permalink to this headline">¶</a></h3>
<p>The example runs on Discovery kit with STM32F407VG MCU and demonstrates
simple project that uses onboard LEDs.</p>
<p>Refer to <a class="reference external" href="https://github.com/forGGe/theCore-blinky">the dedicated repository</a> to check how to build and run the example.</p>
</div>
<div class="section" id="simple-host-hello-world-example">
<h3>Simple host hello world example<a class="headerlink" href="#simple-host-hello-world-example" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/host_hello</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">host</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">none</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">gcc/g++ v5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">none</td>
</tr>
</tbody>
</table>
<p>This example shows theCore running on the host target.
By <cite>host</cite> target is understood an environment capable to both compile and
run theCore applications.</p>
<p>Application demonstrates a console stream usage and a simple assertion.</p>
<div class="section" id="building">
<h4>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="#initial-setup">Initial setup</a> section.</p>
</li>
<li><p class="first">Execute build commands:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">host_hello</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="running">
<h4>Running<a class="headerlink" href="#running" title="Permalink to this headline">¶</a></h4>
<p>Execute resulting application:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">hello</span>
</pre></div>
</div>
</div>
<div class="section" id="expected-output">
<h4>Expected output<a class="headerlink" href="#expected-output" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span>Hello, Host World!
This is an assert demonstration. Application will abort.
hello: /home/user/projects/thecore/examples/host_hello/main.cpp:7: int main(): Assertion `1 == 0&#39; failed.
Aborted (core dumped)
</pre></div>
</div>
</div>
</div>
<div class="section" id="stm32f4-discovery-audio-example-with-cs43l22-audio-dac">
<h3>STM32F4 discovery audio example with CS43L22 audio DAC<a class="headerlink" href="#stm32f4-discovery-audio-example-with-cs43l22-audio-dac" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/cs43l22_audio</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">STM32F4 Discovery board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">UART-to-USB converter attached to the USART3, headphones</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">openocd, minicom</td>
</tr>
</tbody>
</table>
<ol class="arabic">
<li><p class="first">Attach any preferable UART-to-USB converter <a class="reference external" href="http://www.geekfactory.mx/wp-content/uploads/2013/06/converdidor_usb_ttl_rs232_pl_2303hx_01.jpg">such as this</a> module according to following pinout:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PD8 (USART3 TX)</td>
<td>module’s RX</td>
</tr>
<tr class="row-even"><td>PD9 (USART3 RX)</td>
<td>module’s TX</td>
</tr>
<tr class="row-odd"><td>GND</td>
<td>module’s GND</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Below is the example wiring.</p>
<img alt="_images/cs43l22_audio.jpg" src="_images/cs43l22_audio.jpg" />
<div class="section" id="id1">
<h4>Building<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="#initial-setup">Initial setup</a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">cs43l22_audio</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="id2">
<h4>Running<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Firmware will be flashed via <code class="docutils literal"><span class="pre">openocd</span></code> and <code class="docutils literal"><span class="pre">gdb</span></code>.</p>
<ol class="arabic">
<li><p class="first">Connect stm32f4 Discovery board to USB cable and connect USB &lt;-&gt; UART converter to the PC.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">openocd</span></code> in the separate terminal using script provided by theCore.
Alternatively, you can use script from openocd installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">theCore</span>
<span class="n">openocd</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">stm32f4discovery</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with USB &lt;-&gt; UART converter.
(<code class="docutils literal"><span class="pre">/dev/ttyUSB0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB0</span>
</pre></div>
</div>
</li>
<li><p class="first">Provided that your main terminal’s current directory is <code class="docutils literal"><span class="pre">build</span></code>,
launch <code class="docutils literal"><span class="pre">gdb</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From the build directory</span>
<span class="n">arm</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="o">-</span><span class="n">gdb</span> <span class="n">audio</span>
</pre></div>
</div>
</li>
<li><p class="first">Under GDB shell, connect to <code class="docutils literal"><span class="pre">openocd</span></code> and flash firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>(gdb) target remote :3333
Remote debugging using :3333
0x00000000 in ?? ()

(gdb) monitor reset halt
target state: halted
target halted due to debug-request, current mode: Thread
xPSR: 0x01000000 pc: 0x08000188 msp: 0x20020000

(gdb) load
Loading section .text, size 0x4724 lma 0x8000000
Loading section .init_array, size 0xc lma 0x8004724
Loading section .rodata, size 0x228 lma 0x8004730
Loading section .data, size 0x24 lma 0x8004958
Start address 0x8000188, load size 18812
Transfer rate: 14 KB/sec, 3762 bytes/write.
</pre></div>
</div>
</li>
<li><p class="first">Start new firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Attach headphones to the audio jack on Discovery board.</p>
</li>
</ol>
</div>
<div class="section" id="id3">
<h4>Expected output<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">theCore</span>
<span class="n">Playing</span> <span class="n">audio</span> <span class="n">sample</span><span class="o">...</span>
</pre></div>
</div>
<p>In headphones you should hear cool 8-bit sound.</p>
</div>
</div>
<div class="section" id="stm32f4-discovery-and-htu21d-temperature-and-humidity-sensor">
<h3>STM32F4 discovery and HTU21D temperature and humidity sensor<a class="headerlink" href="#stm32f4-discovery-and-htu21d-temperature-and-humidity-sensor" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/htu21d</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">STM32F4 Discovery board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">UART-to-USB converter attached to the USART2, HTU21D sensor</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">openocd, minicom</td>
</tr>
</tbody>
</table>
<div class="section" id="wiring">
<h4>Wiring<a class="headerlink" href="#wiring" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Connect <a class="reference external" href="https://cdn-shop.adafruit.com/datasheets/1899_HTU21D.pdf">HTU21D</a> to I2C1 on the Discovery board using following pins:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PB6 (I2C1 SCL)</td>
<td>sensor’s SCL</td>
</tr>
<tr class="row-even"><td>PB9 (I2C1 SDA)</td>
<td>sensor’s SDA</td>
</tr>
<tr class="row-odd"><td>+3.3V</td>
<td>sensor’s VDD</td>
</tr>
<tr class="row-even"><td>GND</td>
<td>sensor’s GND</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Attach any preferable UART-to-USB converter <a class="reference external" href="http://www.geekfactory.mx/wp-content/uploads/2013/06/converdidor_usb_ttl_rs232_pl_2303hx_01.jpg">such as this</a> module according to following pinout:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PD5 (USART2 TX)</td>
<td>module’s RX</td>
</tr>
<tr class="row-even"><td>PD6 (USART2 RX)</td>
<td>module’s TX</td>
</tr>
<tr class="row-odd"><td>GND</td>
<td>module’s GND</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Below is the example wiring.</p>
<img alt="_images/htu21d.jpg" src="_images/htu21d.jpg" />
</div>
<div class="section" id="id4">
<h4>Building<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="#initial-setup">Initial setup</a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">htu21d</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="id5">
<h4>Running<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Firmware will be flashed via <code class="docutils literal"><span class="pre">openocd</span></code> and <code class="docutils literal"><span class="pre">gdb</span></code>.</p>
<ol class="arabic">
<li><p class="first">Connect stm32f4 Discovery board to USB cable and connect USB &lt;-&gt; UART converter to the PC.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">openocd</span></code> in the separate terminal using script provided by theCore.
Alternatively, you can use script from openocd installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">theCore</span>
<span class="n">openocd</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">stm32f4discovery</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with USB &lt;-&gt; UART converter.
(<code class="docutils literal"><span class="pre">/dev/ttyUSB0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB0</span>
</pre></div>
</div>
</li>
<li><p class="first">Provided that your main terminal’s current directory is <code class="docutils literal"><span class="pre">build</span></code>,
launch <code class="docutils literal"><span class="pre">gdb</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From the build directory</span>
<span class="n">arm</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="o">-</span><span class="n">gdb</span> <span class="n">htu21d_example</span>
</pre></div>
</div>
</li>
<li><p class="first">Under GDB shell, connect to <code class="docutils literal"><span class="pre">openocd</span></code> and flash firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>(gdb) target remote :3333
Remote debugging using :3333
0x00000000 in ?? ()

(gdb) monitor reset halt
target state: halted
target halted due to debug-request, current mode: Thread
xPSR: 0x01000000 pc: 0x08000188 msp: 0x20020000

(gdb) load
Loading section .text, size 0x7678 lma 0x8000000
Loading section .data, size 0x3c lma 0x8007678
Start address 0x800477c, load size 30388
Transfer rate: 18 KB/sec, 10129 bytes/write.
</pre></div>
</div>
</li>
<li><p class="first">Start new firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Watch console output.</p>
</li>
</ol>
</div>
<div class="section" id="id6">
<h4>Expected output<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">theCore</span>
<span class="n">Starting</span> <span class="n">HTU21D</span> <span class="n">sensor</span><span class="o">...</span>
<span class="n">Reset</span> <span class="n">done</span>
<span class="n">Temperature</span><span class="p">:</span> <span class="mf">21.722</span> <span class="n">Celsius</span>   <span class="n">Humidity</span><span class="p">:</span> <span class="mf">40.882</span><span class="o">%</span>
<span class="n">Temperature</span><span class="p">:</span> <span class="mf">21.712</span> <span class="n">Celsius</span>   <span class="n">Humidity</span><span class="p">:</span> <span class="mf">40.859</span><span class="o">%</span>
<span class="n">Temperature</span><span class="p">:</span> <span class="mf">21.701</span> <span class="n">Celsius</span>   <span class="n">Humidity</span><span class="p">:</span> <span class="mf">40.852</span><span class="o">%</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="stm32f4-discovery-and-external-interrupts-from-user-button">
<h3>STM32F4 discovery and external interrupts from user button<a class="headerlink" href="#stm32f4-discovery-and-external-interrupts-from-user-button" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/stm32f4_exti</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">STM32F4 Discovery board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">UART-to-USB converter attached to the USART3</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">openocd, minicom</td>
</tr>
</tbody>
</table>
<p>EXTI - the external interrupt.</p>
<blockquote>
<div><p>An external interrupt is a computer system interrupt that happens as a result
of outside interference, whether that’s from the user, from peripherals,
from other hardware devices or through a network. These are different
than internal interrupts that happen automatically as the machine
reads through program instructions.</p>
<p class="attribution">&mdash;<a class="reference external" href="https://www.techopedia.com/definition/7115/external-interrupt">Techopedia</a></p>
</div></blockquote>
<p>In this application, one particular type of external interrupt is used:
GPIO line interrupt. When voltage level changes on the line (e.g. when button is
pressed), interrupt is generated.</p>
<div class="section" id="id7">
<h4>Wiring<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Attach any preferable UART-to-USB converter <a class="reference external" href="http://www.geekfactory.mx/wp-content/uploads/2013/06/converdidor_usb_ttl_rs232_pl_2303hx_01.jpg">such as this</a> module according to following pinout:</p>
<table border="1" class="docutils">
<colgroup>
<col width="53%" />
<col width="47%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>PD8 (USART3 TX)</td>
<td>module’s RX</td>
</tr>
<tr class="row-even"><td>PD9 (USART3 RX)</td>
<td>module’s TX</td>
</tr>
<tr class="row-odd"><td>GND</td>
<td>module’s GND</td>
</tr>
</tbody>
</table>
</li>
</ol>
<p>Below is the example wiring.</p>
<img alt="_images/stm32f4_exti.jpg" src="_images/stm32f4_exti.jpg" />
</div>
<div class="section" id="id8">
<h4>Building<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="#initial-setup">Initial setup</a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">examples</span><span class="o">/</span><span class="n">stm32f4_exti</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="id9">
<h4>Running<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>Firmware will be flashed via <code class="docutils literal"><span class="pre">openocd</span></code> and <code class="docutils literal"><span class="pre">gdb</span></code>.</p>
<ol class="arabic">
<li><p class="first">Connect stm32f4 Discovery board to USB cable and connect USB &lt;-&gt; UART converter to the PC.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">openocd</span></code> in the separate terminal using script provided by theCore.
Alternatively, you can use script from openocd installation.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">cd</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">theCore</span>
<span class="n">openocd</span> <span class="o">-</span><span class="n">f</span> <span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">stm32f4discovery</span><span class="o">.</span><span class="n">cfg</span>
</pre></div>
</div>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with USB &lt;-&gt; UART converter.
(<code class="docutils literal"><span class="pre">/dev/ttyUSB0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyUSB0</span>
</pre></div>
</div>
</li>
<li><p class="first">Provided that your main terminal’s current directory is <code class="docutils literal"><span class="pre">build</span></code>,
launch <code class="docutils literal"><span class="pre">gdb</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From the build directory</span>
<span class="n">arm</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">eabi</span><span class="o">-</span><span class="n">gdb</span> <span class="n">htu21d_example</span>
</pre></div>
</div>
</li>
<li><p class="first">Under GDB shell, connect to <code class="docutils literal"><span class="pre">openocd</span></code> and flash firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>(gdb) target remote :3333
Remote debugging using :3333
0x00000000 in ?? ()

(gdb) monitor reset halt
target state: halted
target halted due to debug-request, current mode: Thread
xPSR: 0x01000000 pc: 0x08000188 msp: 0x20020000

(gdb) load
Loading section .text, size 0x4724 lma 0x8000000
Loading section .init_array, size 0xc lma 0x8004724
Loading section .rodata, size 0x228 lma 0x8004730
Loading section .data, size 0x24 lma 0x8004958
Start address 0x8000188, load size 18812
Transfer rate: 14 KB/sec, 3762 bytes/write.
</pre></div>
</div>
</li>
<li><p class="first">Start new firmware:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">gdb</span><span class="p">)</span> <span class="k">continue</span>
<span class="n">Continuing</span><span class="o">.</span>
</pre></div>
</div>
</li>
<li><p class="first">Press blue user button on the Discovery board and observe output in <code class="docutils literal"><span class="pre">minicom</span></code>.</p>
</li>
</ol>
</div>
<div class="section" id="id10">
<h4>Expected output<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<ul>
<li><p class="first">Before button press:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Welcome to theCore
Hello, Embedded World!
</pre></div>
</div>
</li>
<li><p class="first">After each button press:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>Button pressed!
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="tm4c123g-launchpad-blinky">
<h3>TM4C123G LaunchPad blinky<a class="headerlink" href="#tm4c123g-launchpad-blinky" title="Permalink to this headline">¶</a></h3>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Location:</th><td class="field-body"><code class="docutils literal"><span class="pre">examples/tm4c_led</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Target:</th><td class="field-body">Tiva C Series TM4C123G LaunchPadEvaluation Board</td>
</tr>
<tr class="field-odd field"><th class="field-name">External HW:</th><td class="field-body">none</td>
</tr>
<tr class="field-even field"><th class="field-name">Toolchain:</th><td class="field-body">GNU arm-none-eabi v.5.2 or newer</td>
</tr>
<tr class="field-odd field"><th class="field-name">Additional SW:</th><td class="field-body">UniFlash, minicom</td>
</tr>
</tbody>
</table>
<div class="section" id="id11">
<h4>Wiring<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>No special wiring is required. Just connect the board to the powered USB port.</p>
<p>Below is the board image showing simple USB connection.</p>
<img alt="_images/tm4c_led.jpg" src="_images/tm4c_led.jpg" />
</div>
<div class="section" id="id12">
<h4>Building<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Complete <a class="reference internal" href="#initial-setup">Initial setup</a> section.</p>
</li>
<li><p class="first">Execute build commands.
The CMake Toolchain file is required to build this application.
theCore already has one suitable for this target.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_TOOLCHAIN_FILE</span><span class="o">=../../</span><span class="n">toolchains</span><span class="o">/</span><span class="n">arm</span><span class="o">-</span><span class="n">cm4</span><span class="o">-</span><span class="n">gnu</span><span class="o">.</span><span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="id13">
<h4>Running<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Flash firmware via <a class="reference external" href="http://processors.wiki.ti.com/index.php/Category:CCS_UniFlash">UniFlash</a>. The UniFlash interface is straightforward.</p>
</li>
<li><p class="first">Launch <code class="docutils literal"><span class="pre">minicom</span></code> with device associated with the board.
(<code class="docutils literal"><span class="pre">/dev/ttyACM0</span></code> here used as an example):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># From new terminal</span>
<span class="n">minicom</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="id14">
<h4>Expected output<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>In <code class="docutils literal"><span class="pre">minicom</span></code> you should be able to see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Welcome</span> <span class="n">to</span> <span class="n">theCore</span>
<span class="n">Starting</span> <span class="n">TM4C</span> <span class="n">led</span> <span class="n">demo</span><span class="o">...</span>
</pre></div>
</div>
<p>On-board LED will blink with the different (RGB) colors.</p>
</div>
</div>
</div>
<span id="document-project_structure"></span><div class="section" id="project-structure">
<h2>Project structure<a class="headerlink" href="#project-structure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="top-level-directories">
<h3>Top-level directories<a class="headerlink" href="#top-level-directories" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="exported-headers">
<h3>Exported headers<a class="headerlink" href="#exported-headers" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="build-system">
<h3>Build system<a class="headerlink" href="#build-system" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-arch"></span><div class="section" id="supported-architectures">
<h2>Supported architectures<a class="headerlink" href="#supported-architectures" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
<div class="section" id="cortex-m3-and-m4">
<h3>Cortex M3 and M4<a class="headerlink" href="#cortex-m3-and-m4" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="host">
<h3>Host<a class="headerlink" href="#host" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-platforms"></span><div class="section" id="supported-platforms">
<span id="thecore-platforms"></span><h2>Supported platforms<a class="headerlink" href="#supported-platforms" title="Permalink to this headline">¶</a></h2>
<div class="section" id="st-stm32f4">
<h3>ST STM32F4<a class="headerlink" href="#st-stm32f4" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="st-stm32l1">
<h3>ST STM32L1<a class="headerlink" href="#st-stm32l1" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="kinetis-ke02z">
<h3>Kinetis KE02Z<a class="headerlink" href="#kinetis-ke02z" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="particle-electron">
<h3>Particle Electron<a class="headerlink" href="#particle-electron" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="tiva-c-series-tm4c123g">
<h3>Tiva C series TM4C123G<a class="headerlink" href="#tiva-c-series-tm4c123g" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-drivers"></span><div class="section" id="drivers">
<h2>Drivers<a class="headerlink" href="#drivers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="cirrus-logic-cs43l22-audio-dac">
<h3>Cirrus Logic CS43L22 audio DAC<a class="headerlink" href="#cirrus-logic-cs43l22-audio-dac" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="hm-10-bluetooth-btle-module">
<h3>HM-10 Bluetooth BTLE module<a class="headerlink" href="#hm-10-bluetooth-btle-module" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="pc8544-nokia-5110-display">
<h3>PC8544 Nokia 5110 display<a class="headerlink" href="#pc8544-nokia-5110-display" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="sdspi-driver">
<h3>SDSPI driver<a class="headerlink" href="#sdspi-driver" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="bh1750-digital-light-sensor">
<h3>BH1750 Digital Light sensor<a class="headerlink" href="#bh1750-digital-light-sensor" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="fc-28-moisture-sensor">
<h3>FC-28 moisture sensor<a class="headerlink" href="#fc-28-moisture-sensor" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="htu21d-humidity-and-temperature-sensor">
<h3>HTU21D humidity and temperature sensor<a class="headerlink" href="#htu21d-humidity-and-temperature-sensor" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-utilities"></span><div class="section" id="libraries-and-utilities">
<h2>Libraries and utilities<a class="headerlink" href="#libraries-and-utilities" title="Permalink to this headline">¶</a></h2>
<div class="section" id="console-streams">
<h3>Console streams<a class="headerlink" href="#console-streams" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="assertions-and-error-handling">
<h3>Assertions and error handling<a class="headerlink" href="#assertions-and-error-handling" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="filesystem">
<h3>Filesystem<a class="headerlink" href="#filesystem" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="newlib-stubs">
<h3>Newlib stubs<a class="headerlink" href="#newlib-stubs" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="configurator">
<h3>Configurator<a class="headerlink" href="#configurator" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-os_layer"></span><div class="section" id="os-abstraction-layer">
<h2>OS abstraction layer<a class="headerlink" href="#os-abstraction-layer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="no-os-abstractions">
<h3>No-OS abstractions<a class="headerlink" href="#no-os-abstractions" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="freertos">
<h3>FreeRTOS<a class="headerlink" href="#freertos" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="posix-host">
<h3>POSIX (host)<a class="headerlink" href="#posix-host" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-community"></span><div class="section" id="community-and-developer-guidelines">
<span id="thecore-developerdocs"></span><h2>Community and developer guidelines<a class="headerlink" href="#community-and-developer-guidelines" title="Permalink to this headline">¶</a></h2>
<p>To make referencing easier, rules and guidelines (if present) are numbered inside section.</p>
<div class="section" id="roadmap">
<span id="thecore-roadmap"></span><h3>Roadmap<a class="headerlink" href="#roadmap" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="branching-and-release-model">
<span id="thecore-branching"></span><h3>Branching and release model<a class="headerlink" href="#branching-and-release-model" title="Permalink to this headline">¶</a></h3>
<p>There are two main branches - <code class="docutils literal"><span class="pre">develop</span></code> and <code class="docutils literal"><span class="pre">master</span></code>.
Both branches are protected against force-pushing unless it is really-really
required (almost never happen).</p>
<p>As names state, all the development (normally) happens in <code class="docutils literal"><span class="pre">develop</span></code> branch,
while <code class="docutils literal"><span class="pre">master</span></code> contains stable versions. <code class="docutils literal"><span class="pre">master</span></code> branch is tagged according
to <a class="reference external" href="http://semver.org/">the semantic versioning approach</a>.</p>
<p>Full explanation of branching model, accepted in theCore you can find in <a class="reference external" href="http://nvie.com/posts/a-successful-git-branching-model/">nvie git article</a>.</p>
</div>
<div class="section" id="code-style">
<h3>Code style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The source formatting script called <code class="docutils literal"><span class="pre">srcformat.sh</span></code> in <code class="docutils literal"><span class="pre">scripts</span></code> directory,
though it is still under development.</p>
</div>
<div class="section" id="whitespaces-and-indentation">
<h4>Whitespaces and indentation<a class="headerlink" href="#whitespaces-and-indentation" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Do not use tabs. Only spaces are allowed.</p>
</li>
<li><p class="first">Set indent to 4 spaces per indent.</p>
</li>
<li><p class="first">Indent <code class="docutils literal"><span class="pre">public</span></code>, <code class="docutils literal"><span class="pre">private</span></code>, <code class="docutils literal"><span class="pre">protected</span></code> with the same indent as
a <code class="docutils literal"><span class="pre">class</span></code> block.</p>
</li>
<li><p class="first">Indent <code class="docutils literal"><span class="pre">class</span></code> block with the same indent as a namespace:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// OK</span>
<span class="k">namespace</span> <span class="n">foo</span>
<span class="p">{</span>

<span class="k">class</span> <span class="nc">entity</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="cm">/* */</span>
<span class="k">private</span><span class="o">:</span>
    <span class="cm">/* */</span>
<span class="k">protected</span><span class="o">:</span>
    <span class="cm">/* */</span>
<span class="p">};</span>

<span class="p">}</span> <span class="c1">// namespace foo</span>
</pre></div>
</div>
</li>
<li><p class="first">Indent switch blocks so that the <code class="docutils literal"><span class="pre">case</span> <span class="pre">X:</span></code> statements are indented in the switch block:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// OK</span>
<span class="k">switch</span> <span class="p">(</span><span class="n">foo</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>

    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="p">{</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Do not indent labels.</p>
</li>
<li><p class="first">Do not indent preprocessor block.</p>
</li>
<li><p class="first">Insert spaces around operators, except <code class="docutils literal"><span class="pre">++</span></code>, <code class="docutils literal"><span class="pre">--</span></code>, <code class="docutils literal"><span class="pre">!</span></code>, <code class="docutils literal"><span class="pre">.</span></code>, <code class="docutils literal"><span class="pre">-&gt;</span></code>, <code class="docutils literal"><span class="pre">*</span></code> and <code class="docutils literal"><span class="pre">&amp;</span></code>.</p>
</li>
<li><p class="first">Insert space padding between <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">for</span></code>, <code class="docutils literal"><span class="pre">while</span></code> and the following bracket.</p>
</li>
<li><p class="first"><strong>Do not leave trailing whitespaces.</strong></p>
</li>
</ol>
</div>
<div class="section" id="bracket-placement">
<h4>Bracket placement<a class="headerlink" href="#bracket-placement" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Use <a class="reference external" href="https://en.wikipedia.org/wiki/Indent_style#Variant:_1TBS_.28OTBS.29">One True Bracket Style</a>.</p>
</li>
<li><p class="first">Place brackets in namespaces, classes, extern-“C” and functions on the next line, e.g:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// Wrong</span>
<span class="k">namespace</span> <span class="n">foo</span> <span class="p">{</span>

<span class="p">}</span>

<span class="c1">// OK</span>
<span class="k">namespace</span> <span class="n">bar</span>
<span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Add brackets to unbracketed one line conditional statements (e.g. <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">for</span></code>, <code class="docutils literal"><span class="pre">while</span></code>…).</p>
</li>
<li><p class="first">Do not put whitespace between angle brackets in template definitions:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// Good</span>
<span class="n">foo</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">bar</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span> <span class="n">obj</span><span class="p">;</span>

<span class="c1">// Bad</span>
<span class="n">foo</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="n">bar</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">obj</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="code-length">
<h4>Code length<a class="headerlink" href="#code-length" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>Prefer 80 character code line length. 100 characters is a maximum allowed line length.</li>
<li>Prefer to keep functions and methods with not more than 100 lines of code.</li>
</ol>
</div>
<div class="section" id="naming">
<h4>Naming<a class="headerlink" href="#naming" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first">Use <a class="reference external" href="https://en.wikipedia.org/wiki/Snake_case">snake_case</a> for identifiers.</p>
</li>
<li><p class="first">Use <code class="docutils literal"><span class="pre">m_</span></code> prefix when naming private and protected class members.</p>
</li>
<li><p class="first">Use CamelCase style for template parameters only:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">CrazyAllocator</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">my_strange_container</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="comments">
<h4>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h4>
<ol class="arabic">
<li><p class="first"><strong>Do not leave commented out code.</strong></p>
</li>
<li><p class="first">Prefer not keeping <code class="docutils literal"><span class="pre">TODO</span></code> in code without corresponding issue.
Place issue number next to the <code class="docutils literal"><span class="pre">TODO</span></code> with a short explanation why it is there:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">// TODO #123: replace foo() with something that exposes smaller IRQ latency.</span>
<span class="n">foo</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p class="first">Use doxygen for commenting the function prototypes and class methods.</p>
</li>
<li><p class="first">Use C++ comment lines for doxygen commenting:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">//! This function does something.</span>
<span class="c1">//! \details Also it calls 911.</span>
<span class="kt">void</span> <span class="nf">foo</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p class="first">Do not use <code class="docutils literal"><span class="pre">\brief</span></code> doxygen directive. Brief tag is set automatically for first sentence (until the first dot).
See also <a class="reference external" href="https://www.stack.nl/~dimitri/doxygen/manual/config.html#cfg_javadoc_autobrief">autobrief docs</a>.</p>
</li>
<li><p class="first">Do not add redundant Doxygen comments, like:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="c1">//! Set the size.</span>
<span class="c1">//! \param size The size.</span>
<span class="kt">void</span> <span class="nf">set_size</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">size</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="commit-and-pr-style">
<h3>Commit and PR style<a class="headerlink" href="#commit-and-pr-style" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Try to follow common <a class="reference external" href="https://chris.beams.io/posts/git-commit/">git guidelines</a>.</p>
</li>
<li><p class="first"><strong>Do not keep commits named just</strong> <code class="docutils literal"><span class="pre">FIX</span></code> <strong>,</strong> <code class="docutils literal"><span class="pre">Review</span></code> <strong>,</strong> <code class="docutils literal"><span class="pre">tmp</span></code> <strong>, etc.</strong></p>
</li>
<li><p class="first">Prefer placing issue number at the start of the summary line, prefixed with <code class="docutils literal"><span class="pre">&gt;#</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>&gt;#911 Implement calling police officer
</pre></div>
</div>
<p>This will be recognized by GitHub as issue reference.
Note that simply putting <code class="docutils literal"><span class="pre">#</span></code> at the beginning will not do the trick.
Since a line with the <code class="docutils literal"><span class="pre">#</span></code> at the start is interpreted as the commentary.</p>
</li>
<li><p class="first"><strong>Do not</strong> include issue number in the pull request name.</p>
</li>
<li><p class="first">Use <code class="docutils literal"><span class="pre">[WIP]</span></code> (Work In Progress) prefix for PRs that are still in progress or review
and should not be merged right away.</p>
</li>
</ol>
</div>
</div>
<span id="document-docs"></span><div class="section" id="documentation-development-and-contribution">
<h2>Documentation development and contribution<a class="headerlink" href="#documentation-development-and-contribution" title="Permalink to this headline">¶</a></h2>
<p>theCore documentation, as you may have noticed, is hosted on GitHub pages and
built using <a class="reference external" href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> with few extensions:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://docs.readthedocs.io/en/latest/theme.html">Read The Docs theme</a> - awesome theme.</li>
<li><a class="reference external" href="https://sphinxcontrib-fulltoc.readthedocs.io">FullToc</a> - full ToC in the sidebar.</li>
</ul>
</div></blockquote>
<p>All the documentation sources placed under <code class="docutils literal"><span class="pre">doc</span></code> top-level directory.</p>
<p>To contribute to the documentation, you probably would like to first build
and validate docs locally. For that, build dependencies must be installed either
manually or by using Nix. Check the <a class="reference internal" href="index.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> for more info about
Nix option.</p>
<p>Following sections will provide you with insights about docs structure and build
procedure.</p>
<div class="section" id="building-documentation">
<h3>Building documentation<a class="headerlink" href="#building-documentation" title="Permalink to this headline">¶</a></h3>
<p>theCore build system provides a separate target for building documentation, so
there is no need to invoke Sphinx manually. Instead, proceed as follows:</p>
<ol class="arabic">
<li><p class="first">Finish <a class="reference internal" href="index.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> to get Sphinx and additional extensions.</p>
</li>
<li><p class="first">Launch documentation build:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span># From theCore directory
mkdir doc_build
cd doc_build
cmake ..
make core_sphinx
</pre></div>
</div>
</li>
<li><p class="first">Open generated docs by any preferable browser:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">doc_build/doc/sphinx/theCore/index.html</span></code> - main page of multi-page version.</li>
<li><code class="docutils literal"><span class="pre">doc_build/doc/sphinx/theCore/singlehtml/index.html</span></code> - main page of single-paged version.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="what-all-these-sections-are-about">
<h3>What all these sections are about?<a class="headerlink" href="#what-all-these-sections-are-about" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="publishing-docs-on-github-pages">
<h3>Publishing docs on github pages<a class="headerlink" href="#publishing-docs-on-github-pages" title="Permalink to this headline">¶</a></h3>
<p>As noted previously, docs are hosted in GitHub pages. <a class="reference external" href="https://github.com/forGGe/forGGe.github.io">The separate repository</a>
holds auto-generated static HTML files which are automatically displayed if placed in
master branch of that repo. Jekyll is disabled.</p>
<p>See also <a class="reference external" href="https://help.github.com/articles/user-organization-and-project-pages/">the GitHub pages docs</a> for more information.</p>
<p>Contributing to the documentation consist of creating a PR against <a class="reference external" href="https://github.com/forGGe/theCore">theCore repository</a>.</p>
<p>After the PR is opened, the new documentation is processed by the author manually in following fashion:</p>
<ol class="arabic">
<li><p class="first">New docs are build and tested locally, as described in <a class="reference internal" href="#building-documentation">Building documentation</a> section.</p>
</li>
<li><p class="first">Generated static files are copied to the github pages clone:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>cp doc_build/doc/sphinx/* /path/to/the/gh_pages/ -rv
</pre></div>
</div>
</li>
<li><p class="first">Changes are committed and pushed to the remote:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>git add -u
git commit
git push origin master
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<span id="document-testing"></span><div class="section" id="testing-and-ci">
<h2>Testing and CI<a class="headerlink" href="#testing-and-ci" title="Permalink to this headline">¶</a></h2>
<div class="section" id="unit-tests">
<h3>Unit tests<a class="headerlink" href="#unit-tests" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
<div class="section" id="on-device-tests">
<h3>On-device tests<a class="headerlink" href="#on-device-tests" title="Permalink to this headline">¶</a></h3>
<p>theCore testing facilities provides way to create on-device and system tests
in modular and reusable manner.
theCore uses <a class="reference external" href="http://www.throwtheswitch.org/unity/">the Unity test framework</a> to create test cases.</p>
<p>On-device tests are located in the <code class="docutils literal"><span class="pre">tests</span></code> top-level directory.</p>
<div class="section" id="basic-entities">
<h4>Basic entities<a class="headerlink" href="#basic-entities" title="Permalink to this headline">¶</a></h4>
<p>A test case is a code that performs validation of the particular theCore
component or module.</p>
<p>Each test, or test case, resides in separate directory under <code class="docutils literal"><span class="pre">tests/cases</span></code> dir.
To be recognizable by theCore testing facilities the test case
must contain a definition file with <code class="docutils literal"><span class="pre">case_defs.cmake</span></code> name.</p>
<p>Test case definition file must (at least) define <code class="docutils literal"><span class="pre">CASE_SOURCES</span></code> CMake variable.
<code class="docutils literal"><span class="pre">CASE_SOURCES</span></code> must contain list of test case source files.</p>
<p>See [the unity_demo test case](cases/unity_demo) as an example.</p>
<p>You may check <code class="docutils literal"><span class="pre">tests/cases/unity_demo</span></code> as an example.</p>
</div>
<div class="section" id="targets-and-mcus">
<h4>Targets and MCUs<a class="headerlink" href="#targets-and-mcus" title="Permalink to this headline">¶</a></h4>
<p>A target is a board where tests should be executed.</p>
<p>Multiple boards can be built around single MCU type.
MCU types are placed in the <code class="docutils literal"><span class="pre">tests/mcus</span></code> directory.
Each MCU must contain <code class="docutils literal"><span class="pre">mcu_defs.cmake</span></code> and <code class="docutils literal"><span class="pre">mcu_defs.hpp</span></code> files.
Those definition files can contain arbitrary data specific to the concrete microcontroller.</p>
<p>The TM4C MCU definition file (<code class="docutils literal"><span class="pre">tests/mcus/tm4c123gh6pm/mcu_defs.cmake</span></code>)
provided here as an example:</p>
<div class="highlight-cmake"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="s">CONFIG_PLATFORM</span> <span class="s">tm4c</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CONFIG_PLATFORM_DEVICE</span> <span class="s">TM4C123GH6PM</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>As shown, CMake file sets the platform associated with that MCU (<code class="docutils literal"><span class="pre">CONFIG_PLATFORM</span></code>)
and the MCU model (<code class="docutils literal"><span class="pre">CONFIG_PLATFORM_DEVICE</span></code>).</p>
<p>Targets are residing in <code class="docutils literal"><span class="pre">tests/targets</span></code> directory and can reuse
MCU definitions in its own definition files: <code class="docutils literal"><span class="pre">target_defs.cmake</span></code>
and <code class="docutils literal"><span class="pre">target_defs.hpp</span></code>.</p>
<p>Targets must also declare set of test suites that they can handle
(more on this in the <a class="reference internal" href="#suites">Suites</a> section).</p>
<p>Good example of the test target is a  STM32 discovery target.
It can be found in <code class="docutils literal"><span class="pre">targets/stm32f4discovery_simple</span></code> directory.</p>
</div>
<div class="section" id="suites">
<h4>Suites<a class="headerlink" href="#suites" title="Permalink to this headline">¶</a></h4>
<p>Every target can run <cite>limited</cite> set of possible tests.
Limitations might be caused by lack of ROM, RAM or absence of the required hardware.
Sets of tests that can be executed on the target called <strong>suite</strong>.</p>
<p>Suites are specific to the target, thus placed under <code class="docutils literal"><span class="pre">&lt;target_name&gt;/suites</span></code> directory.
Suites are compiled into executables, thus every suite must contain ordinary
<code class="docutils literal"><span class="pre">CMakeLists.txt</span></code> usable with theCore.</p>
<p>Suite does not need to contain any source files except the init code
(usually placed in <code class="docutils literal"><span class="pre">suite_init.cpp</span></code>) that runs when board starts.
Suite launchers are autogenerated by <code class="docutils literal"><span class="pre">scripts/gen_suite.py</span></code> script.</p>
<p>See Unity demo suite on stm32f4 discovery target placed under
<code class="docutils literal"><span class="pre">targets/stm32f4discovery_simple/suites/unity_demo</span></code> as an example.</p>
</div>
<div class="section" id="building-thecore-suites">
<h4>Building theCore suites<a class="headerlink" href="#building-thecore-suites" title="Permalink to this headline">¶</a></h4>
<p>Existing test suites can be compiled by the following procedure
(do not forget to complete <a class="reference internal" href="index.html#thecore-gettingstarted"><span class="std std-ref">Getting started</span></a> guide to obtain Nix environment):</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>mkdir tests_build
cd tests_build
cmake ../tests
make
</pre></div>
</div>
<p>Paths to suite binaries are recorded in <cite>suite_list.txt</cite> file in the build directory:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>$ cat suite_list.txt
platform_bat,tivac_tm4,/tmp/theCore/tests/build/tivac_tm4/platform_bat.gnu//build/platform_bat,/tmp/build3/tivac_tm4/platform_bat.gnu//build/platform_bat.bin
platform_bat,stm32f4discovery_simple,/tmp/theCore/tests/build/stm32f4discovery_simple/platform_bat.gnu//build/platform_bat,/tmp/build3/stm32f4discovery_simple/platform_bat.gnu//build/platform_bat.bin
platform_bat,stm32f4discovery_simple,/tmp/theCore/tests/build/stm32f4discovery_simple/platform_bat.clang//build/platform_bat,/tmp/build3/stm32f4discovery_simple/platform_bat.clang//build/platform_bat.bin
unity_demo,stm32f4discovery_simple,/tmp/theCore/tests/build/stm32f4discovery_simple/unity_demo.gnu//build/unity_demo,/tmp/build3/stm32f4discovery_simple/unity_demo.gnu//build/unity_demo.bin
unity_demo,tivac_tm4,/tmp/theCore/tests/build/tivac_tm4/unity_demo.gnu//build/unity_demo,/tmp/build3/tivac_tm4/unity_demo.gnu//build/unity_demo.bin
</pre></div>
</div>
</div>
<div class="section" id="launching-suites">
<h4>Launching suites<a class="headerlink" href="#launching-suites" title="Permalink to this headline">¶</a></h4>
<p>Suite binaries obtained in the <a class="reference internal" href="#building-thecore-suites">Building theCore suites</a> can be flashed
into the MCU using either manual approach (using appropriate programmer)
or using <code class="docutils literal"><span class="pre">scripts/flasher.py</span></code> script.</p>
<p>The flasher script tries to flash suite binaries to connected boards
using <code class="docutils literal"><span class="pre">suite_list.txt</span></code> and the description of connected devices
in a form of JSON.</p>
<p>Such JSON must be filled manually with respect to board connected.
Example of the description file (<code class="docutils literal"><span class="pre">/scripts/connected_devices_example.json</span></code>)
demonstrated below:</p>
<div class="highlight-json"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;stm32f4discovery_simple&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;debugger&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;openocd&quot;</span><span class="p">,</span>
      <span class="nt">&quot;flash_params&quot;</span><span class="p">:</span> <span class="s2">&quot;init; reset halt; wait_halt; flash write_image erase {elf_path}; reset run; shutdown&quot;</span><span class="p">,</span>
      <span class="nt">&quot;conf_file&quot;</span> <span class="p">:</span> <span class="s2">&quot;stm32f4discovery.cfg&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>

  <span class="nt">&quot;tivac_tm4&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;debugger&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;openocd&quot;</span><span class="p">,</span>
      <span class="nt">&quot;flash_params&quot;</span><span class="p">:</span> <span class="s2">&quot;init; reset halt; wait_halt; flash write_image erase {elf_path}; reset run; shutdown&quot;</span><span class="p">,</span>
      <span class="nt">&quot;conf_file&quot;</span> <span class="p">:</span> <span class="s2">&quot;ek-lm4f120xl.cfg&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="relation-to-the-examples">
<h4>Relation to the examples<a class="headerlink" href="#relation-to-the-examples" title="Permalink to this headline">¶</a></h4>
<p>Examples described in <a class="reference internal" href="index.html#thecore-examples"><span class="std std-ref">Examples</span></a> section and on-device tests
sometimes contains overlapping functionality but have different purpose.</p>
<p>Test cases and suites are not so well documented and indicative to be threatened
as good examples.</p>
</div>
</div>
<div class="section" id="travis">
<h3>Travis<a class="headerlink" href="#travis" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
</div>
</div>
<span id="document-credits"></span><div class="section" id="credits-and-acknowledgements">
<span id="thecore-credits"></span><h2>Credits and acknowledgements<a class="headerlink" href="#credits-and-acknowledgements" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This section is under construction.</p>
</div>
<div class="section" id="invoking-sphinx-from-cmake">
<h3>Invoking Sphinx from CMake<a class="headerlink" href="#invoking-sphinx-from-cmake" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://eb2.co/blog/2012/03/sphinx-and-cmake-beautiful-documentation-for-c-projects/">Sphinx and CMake: Beautiful Documentation For C++ Projects</a> by Eric Scott Barr
is a great article, describes how to integrate those tools together.
This is how theCore builds and deploys its documentation.</p>
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1970, Max Olender.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>